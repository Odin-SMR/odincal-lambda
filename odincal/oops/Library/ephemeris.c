#include <stdio.h>
#include <math.h>
#include <stdlib.h>

#include "astrolib.h"

#ifndef PI
#define PI 3.14159265358979323846
#endif

#define TWOPI (2.0*PI)

static char rcsid[] = "$Id$";

/************************************************************************/
/*                                                                      */
/* ephemeris: calculate apparent positions of the Sun, Moon and         */
/*         planets using harmonic polynomials                           */
/*                                                                      */
/*         for reference see:                                           */
/*         T. C. Van Flandern and K. F. Pulkkinen,                      */
/*         Ap.J. (Suppl.) 41, 391-411 (1979)                            */
/*                                                                      */
/************************************************************************/


#define SIN 0
#define COS 1

struct Term {
  double a;
  int nT;
  int trig;
  int trigarg[10];
};

/*
struct Term plonSun[] = {
  {      0.0,12,   7, { 1, 5, 7, 8,13,16,19 } },
  {   6910.0, 0, SIN, { 0, 0, 0, 1, 0, 0, 0 } },
  {     72.0, 0, SIN, { 0, 0, 0, 2, 0, 0, 0 } },
  {    -17.0, 1, SIN, { 0, 0, 0, 1, 0, 0, 0 } },
  {     -7.0, 0, COS, { 0, 0, 0, 1, 0, 0,-1 } },
  {      6.0, 0, SIN, { 1, 0,-1, 0, 0, 0, 0 } },
  {      5.0, 0, SIN, { 0, 0, 0, 4, 0,-8, 3 } },
  {     -5.0, 0, COS, { 0, 0, 0, 2,-2, 0, 0 } },
  {     -4.0, 0, SIN, { 0, 0, 0, 1,-1, 0, 0 } },
  {      4.0, 0, COS, { 0, 0, 0, 4, 0,-8, 3 } },
  {      3.0, 0, SIN, { 0, 0, 0, 2,-2, 0, 0 } },
  {     -3.0, 0, SIN, { 0, 0, 0, 0, 0, 0, 1 } },
  {     -3.0, 0, SIN, { 0, 0, 0, 2, 0, 0,-2 } }
};

struct Term betaSun[] = {
  {      0.0, 0,   7, { 1, 5, 7, 8,13,16,19 } }
};

struct Term rpSun[] = {
  {      0.0, 3,   7, { 1, 5, 7, 8,13,16,19 } },
  {  1.00014, 0, COS, { 0, 0, 0, 0, 0, 0, 0 } },
  { -0.01675, 0, COS, { 0, 0, 0, 1, 0, 0, 0 } },
  { -0.00014, 0, COS, { 0, 0, 0, 2, 0, 0, 0 } }
};
*/
struct Term vSun[9] = {
  {      0.0, 8,   7, { 1, 5, 7, 8,13,16,19 } },
  {  0.39785, 0, SIN, { 0, 0, 1, 0, 0, 0, 0 } },
  { -0.01000, 0, SIN, { 0, 0, 1,-1, 0, 0, 0 } },
  {  0.00333, 0, SIN, { 0, 0, 1, 1, 0, 0, 0 } },
  { -0.00021, 1, SIN, { 0, 0, 1, 0, 0, 0, 0 } },
  {  0.00004, 0, SIN, { 0, 0, 1, 2, 0, 0, 0 } },
  { -0.00004, 0, COS, { 0, 0, 1, 0, 0, 0, 0 } },
  { -0.00004, 0, SIN, { 0, 1,-1, 0, 0, 0, 0 } },
  {  0.00003, 1, SIN, { 0, 0, 1,-1, 0, 0, 0 } }
};

struct Term uSun[6] = {
  {      0.0, 5,   7, { 1, 5, 7, 8,13,16,19 } },
  {  1.00000, 0, COS, { 0, 0, 0, 0, 0, 0, 0 } },
  { -0.03349, 0, COS, { 0, 0, 0, 1, 0, 0, 0 } },
  { -0.00014, 0, COS, { 0, 0, 0, 2, 0, 0, 0 } },
  {  0.00008, 1, COS, { 0, 0, 0, 1, 0, 0, 0 } },
  { -0.00003, 0, SIN, { 0, 0, 0, 1, 0, 0,-1 } }
};

struct Term wSun[15] = {
  {      0.0,14,   7, { 1, 5, 7, 8,13,16,19 } },
  { -0.04129, 0, SIN, { 0, 0, 2, 0, 0, 0, 0 } },
  {  0.03211, 0, SIN, { 0, 0, 0, 1, 0, 0, 0 } },
  {  0.00104, 0, SIN, { 0, 0, 2,-1, 0, 0, 0 } },
  { -0.00035, 0, SIN, { 0, 0, 2, 1, 0, 0, 0 } },
  { -0.00010, 0, COS, { 0, 0, 0, 0, 0, 0, 0 } },
  { -0.00008, 1, SIN, { 0, 0, 0, 1, 0, 0, 0 } },
  { -0.00008, 0, SIN, { 0, 1, 0, 0, 0, 0, 0 } },
  {  0.00007, 0, SIN, { 0, 0, 0, 2, 0, 0, 0 } },
  {  0.00005, 1, SIN, { 0, 0, 2, 0, 0, 0, 0 } },
  {  0.00003, 0, SIN, { 1, 0,-1, 0, 0, 0, 0 } },
  { -0.00002, 0, COS, { 0, 0, 0, 1, 0, 0,-1 } },
  {  0.00002, 0, SIN, { 0, 0, 0, 4, 0,-8, 3 } },
  { -0.00002, 0, SIN, { 0, 0, 0, 1,-1, 0, 0 } },
  { -0.00002, 0, COS, { 0, 0, 0, 2,-2, 0, 0 } }
};
/*
struct Term plonMoon[56] = {
  {      0.0,55,   7, { 2, 3, 4, 5, 7, 8,12 } },
  {  22640.0, 0, SIN, { 1, 0, 0, 0, 0, 0, 0 } },
  {  -4586.0, 0, SIN, { 1, 0,-2, 0, 0, 0, 0 } },
  {   2370.0, 0, SIN, { 0, 0, 2, 0, 0, 0, 0 } },
  {    769.0, 0, SIN, { 2, 0, 0, 0, 0, 0, 0 } },
  {   -668.0, 0, SIN, { 0, 0, 0, 0, 0, 1, 0 } },
  {   -412.0, 0, SIN, { 0, 2, 0, 0, 0, 0, 0 } },
  {   -212.0, 0, SIN, { 2, 0,-2, 0, 0, 0, 0 } },
  {   -206.0, 0, SIN, { 1, 0,-2, 0, 0, 1, 0 } },
  {    192.0, 0, SIN, { 1, 0, 2, 0, 0, 0, 0 } },
  {    165.0, 0, SIN, { 0, 0, 2, 0, 0,-1, 0 } },
  {    148.0, 0, SIN, { 1, 0, 0, 0, 0,-1, 0 } },
  {   -125.0, 0, SIN, { 0, 0, 1, 0, 0, 0, 0 } },
  {   -110.0, 0, SIN, { 1, 0, 0, 0, 0, 1, 0 } },
  {    -55.0, 0, SIN, { 0, 2,-2, 0, 0, 0, 0 } },
  {    -45.0, 0, SIN, { 1, 2, 0, 0, 0, 0, 0 } },
  {     40.0, 0, SIN, { 1,-2, 0, 0, 0, 0, 0 } },
  {    -38.0, 0, SIN, { 1, 0,-4, 0, 0, 0, 0 } },
  {     36.0, 0, SIN, { 3, 0, 0, 0, 0, 0, 0 } },
  {    -31.0, 0, SIN, { 2, 0,-4, 0, 0, 0, 0 } },
  {     28.0, 0, SIN, { 1, 0,-2, 0, 0,-1, 0 } },
  {    -24.0, 0, SIN, { 0, 0, 2, 0, 0, 1, 0 } },
  {     19.0, 0, SIN, { 1, 0,-1, 0, 0, 0, 0 } },
  {     18.0, 0, SIN, { 0, 0, 1, 0, 0, 1, 0 } },
  {     15.0, 0, SIN, { 1, 0, 2, 0, 0,-1, 0 } },
  {     14.0, 0, SIN, { 2, 0, 2, 0, 0, 0, 0 } },
  {     14.0, 0, SIN, { 0, 0, 4, 0, 0, 0, 0 } },
  {    -13.0, 0, SIN, { 3, 0,-2, 0, 0, 0, 0 } },
  {    -11.0, 0, SIN, { 1, 0, 0, 0,16, 0,-18} },
  {     10.0, 0, SIN, { 2, 0, 0, 0, 0,-1, 0 } },
  {      9.0, 0, SIN, { 1,-2,-2, 0, 0, 0, 0 } },
  {      9.0, 0, COS, { 1, 0, 0, 0,16, 0,-18} },
  {     -9.0, 0, SIN, { 2, 0,-2, 0, 0, 1, 0 } },
  {     -8.0, 0, SIN, { 1, 0, 1, 0, 0, 0, 0 } },
  {      8.0, 0, SIN, { 0, 0, 2, 0, 0,-2, 0 } },
  {     -8.0, 0, SIN, { 2, 0, 0, 0, 0, 1, 0 } },
  {     -7.0, 0, SIN, { 0, 0, 0, 0, 0, 2, 0 } },
  {     -7.0, 0, SIN, { 1, 0,-2, 0, 0, 2, 0 } },
  {      7.0, 0, SIN, { 0, 0, 0, 1, 0, 0, 0 } },
  {     -6.0, 0, SIN, { 1,-2, 2, 0, 0, 0, 0 } },
  {     -6.0, 0, SIN, { 0, 2, 2, 0, 0, 0, 0 } },
  {     -4.0, 0, SIN, { 1, 0,-4, 0, 0, 1, 0 } },
  {      4.0, 1, COS, { 1, 0, 0, 0,16, 0,-18} },
  {     -4.0, 0, SIN, { 2, 2, 0, 0, 0, 0, 0 } },
  {      4.0, 1, SIN, { 1, 0, 0, 0,16, 0,-18} },
  {      3.0, 0, SIN, { 1, 0,-3, 0, 0, 0, 0 } },
  {     -3.0, 0, SIN, { 1, 0, 2, 0, 0, 1, 0 } },
  {     -3.0, 0, SIN, { 2, 0,-4, 0, 0, 1, 0 } },
  {      3.0, 0, SIN, { 1, 0, 0, 0, 0,-2, 0 } },
  {      3.0, 0, SIN, { 1, 0,-2, 0, 0,-2, 0 } },
  {     -2.0, 0, SIN, { 2, 0,-2, 0, 0,-1, 0 } },
  {     -2.0, 0, SIN, { 0, 2,-2, 0, 0, 1, 0 } },
  {      2.0, 0, SIN, { 1, 0, 4, 0, 0, 0, 0 } },
  {      2.0, 0, SIN, { 4, 0, 0, 0, 0, 0, 0 } },
  {      2.0, 0, SIN, { 0, 0, 4, 0, 0,-1, 0 } },
  {      2.0, 0, SIN, { 2, 0,-1, 0, 0, 0, 0 } }
};

struct Term betaMoon[39] = {
  {      0.0,38,   7, { 2, 3, 4, 5, 7, 8,12 } },
  {  18461.0, 0, SIN, { 0, 1, 0, 0, 0, 0, 0 } },
  {   1010.0, 0, SIN, { 1, 1, 0, 0, 0, 0, 0 } },
  {   1000.0, 0, SIN, { 1,-1, 0, 0, 0, 0, 0 } },
  {   -624.0, 0, SIN, { 0, 1,-2, 0, 0, 0, 0 } },
  {   -199.0, 0, SIN, { 1,-1,-2, 0, 0, 0, 0 } },
  {   -167.0, 0, SIN, { 1, 1,-2, 0, 0, 0, 0 } },
  {    117.0, 0, SIN, { 0, 1, 2, 0, 0, 0, 0 } },
  {     62.0, 0, SIN, { 2, 1, 0, 0, 0, 0, 0 } },
  {     33.0, 0, SIN, { 1,-1, 2, 0, 0, 0, 0 } },
  {     32.0, 0, SIN, { 2,-1, 0, 0, 0, 0, 0 } },
  {    -30.0, 0, SIN, { 0, 1,-2, 0, 0, 1, 0 } },
  {    -16.0, 0, SIN, { 2, 1,-2, 0, 0, 0, 0 } },
  {     15.0, 0, SIN, { 1, 1, 2, 0, 0, 0, 0 } },
  {     12.0, 0, SIN, { 0, 1,-2, 0, 0,-1, 0 } },
  {     -9.0, 0, SIN, { 1,-1,-2, 0, 0, 1, 0 } },
  {     -8.0, 0, SIN, { 0, 1, 0, 1, 0, 0, 0 } },
  {      8.0, 0, SIN, { 0, 1, 2, 0, 0,-1, 0 } },
  {     -7.0, 0, SIN, { 1, 1,-2, 0, 0, 1, 0 } },
  {      7.0, 0, SIN, { 1, 1, 0, 0, 0,-1, 0 } },
  {     -7.0, 0, SIN, { 1, 1,-4, 0, 0, 0, 0 } },
  {     -6.0, 0, SIN, { 0, 1, 0, 0, 0, 1, 0 } },
  {     -6.0, 0, SIN, { 0, 3, 0, 0, 0, 0, 0 } },
  {      6.0, 0, SIN, { 1,-1, 0, 0, 0,-1, 0 } },
  {     -5.0, 0, SIN, { 0, 1, 1, 0, 0, 0, 0 } },
  {     -5.0, 0, SIN, { 1, 1, 0, 0, 0, 1, 0 } },
  {     -5.0, 0, SIN, { 1,-1, 0, 0, 0, 1, 0 } },
  {      5.0, 0, SIN, { 0, 1, 0, 0, 0,-1, 0 } },
  {      5.0, 0, SIN, { 0, 1,-1, 0, 0, 0, 0 } },
  {      4.0, 0, SIN, { 3, 1, 0, 0, 0, 0, 0 } },
  {     -4.0, 0, SIN, { 0, 1,-4, 0, 0, 0, 0 } },
  {     -3.0, 0, SIN, { 1,-1,-4, 0, 0, 0, 0 } },
  {      3.0, 0, SIN, { 1,-3, 0, 0, 0, 0, 0 } },
  {     -2.0, 0, SIN, { 2,-1,-4, 0, 0, 0, 0 } },
  {     -2.0, 0, SIN, { 0, 3,-2, 0, 0, 0, 0 } },
  {      2.0, 0, SIN, { 2,-1, 2, 0, 0, 0, 0 } },
  {      2.0, 0, SIN, { 1,-1, 2, 0, 0,-1, 0 } },
  {      2.0, 0, SIN, { 2,-1,-2, 0, 0, 0, 0 } },
  {      2.0, 0, SIN, { 3,-1, 0, 0, 0, 0, 0 } }
};

struct Term rpMoon[31] = {
  {      0.0,30,   7, { 2, 3, 4, 5, 7, 8,12 } },
  { 60.36298, 0, COS, { 0, 0, 0, 0, 0, 0, 0 } },
  { -3.27746, 0, COS, { 1, 0, 0, 0, 0, 0, 0 } },
  { -0.57994, 0, COS, { 1, 0,-2, 0, 0, 0, 0 } },
  { -0.46357, 0, COS, { 0, 0, 2, 0, 0, 0, 0 } },
  { -0.08904, 0, COS, { 2, 0, 0, 0, 0, 0, 0 } },
  {  0.03865, 0, COS, { 2, 0,-2, 0, 0, 0, 0 } },
  { -0.03237, 0, COS, { 0, 0, 2, 0, 0,-1, 0 } },
  { -0.02688, 0, COS, { 1, 0, 2, 0, 0, 0, 0 } },
  { -0.02358, 0, COS, { 1, 0,-2, 0, 0, 1, 0 } },
  { -0.02030, 0, COS, { 1, 0, 0, 0, 0,-1, 0 } },
  {  0.01719, 0, COS, { 0, 0, 1, 0, 0, 0, 0 } },
  {  0.01617, 0, COS, { 1, 0, 0, 0, 0, 1, 0 } },
  {  0.01247, 0, COS, { 1,-2, 0, 0, 0, 0, 0 } },
  {  0.00704, 0, COS, { 0, 0, 0, 0, 0, 1, 0 } },
  {  0.00529, 0, COS, { 0, 0, 2, 0, 0, 1, 0 } },
  { -0.00524, 0, COS, { 1, 0,-4, 0, 0, 0, 0 } },
  {  0.00398, 0, COS, { 1, 0,-2, 0, 0,-1, 0 } },
  { -0.00366, 0, COS, { 3, 0, 0, 0, 0, 0, 0 } },
  { -0.00295, 0, COS, { 2, 0,-4, 0, 0, 0, 0 } },
  { -0.00263, 0, COS, { 0, 0, 1, 0, 0, 1, 0 } },
  {  0.00249, 0, COS, { 3, 0,-2, 0, 0, 0, 0 } },
  { -0.00221, 0, COS, { 1, 0, 2, 0, 0,-1, 0 } },
  {  0.00185, 0, COS, { 0, 2,-2, 0, 0, 0, 0 } },
  { -0.00161, 0, COS, { 0, 0, 2, 0, 0,-2, 0 } },
  {  0.00147, 0, COS, { 1, 2,-2, 0, 0, 0, 0 } },
  { -0.00142, 0, COS, { 0, 0, 4, 0, 0, 0, 0 } },
  {  0.00139, 0, COS, { 2, 0,-2, 0, 0, 1, 0 } },
  { -0.00118, 0, COS, { 1, 0,-4, 0, 0, 1, 0 } },
  { -0.00116, 0, COS, { 2, 0, 2, 0, 0, 0, 0 } },
  { -0.00110, 0, COS, { 2, 0, 0, 0, 0,-1, 0 } } 
};
*/
struct Term vMoon[65] = {
  {      0.0,64,   7, { 2, 3, 4, 5, 7, 8,12 } },
  {  0.39558, 0, SIN, { 0, 1, 0, 1, 0, 0, 0 } },
  {  0.08200, 0, SIN, { 0, 1, 0, 0, 0, 0, 0 } },
  {  0.03257, 0, SIN, { 1,-1, 0,-1, 0, 0, 0 } },
  {  0.01092, 0, SIN, { 1, 1, 0, 1, 0, 0, 0 } },
  {  0.00666, 0, SIN, { 1,-1, 0, 0, 0, 0, 0 } },
  { -0.00644, 0, SIN, { 1, 1,-2, 1, 0, 0, 0 } },
  { -0.00331, 0, SIN, { 0, 1,-2, 1, 0, 0, 0 } },
  { -0.00304, 0, SIN, { 0, 1,-2, 0, 0, 0, 0 } },
  { -0.00240, 0, SIN, { 1,-1,-2,-1, 0, 0, 0 } },
  {  0.00226, 0, SIN, { 1, 1, 0, 0, 0, 0, 0 } },
  { -0.00108, 0, SIN, { 1, 1,-2, 0, 0, 0, 0 } },
  { -0.00079, 0, SIN, { 0, 1, 0,-1, 0, 0, 0 } },
  {  0.00078, 0, SIN, { 0, 1, 2, 1, 0, 0, 0 } },
  {  0.00066, 0, SIN, { 0, 1, 0, 1, 0,-1, 0 } },
  { -0.00062, 0, SIN, { 0, 1, 0, 1, 0, 1, 0 } },
  { -0.00050, 0, SIN, { 1,-1,-2, 0, 0, 0, 0 } },
  {  0.00045, 0, SIN, { 2, 1, 0, 1, 0, 0, 0 } },
  { -0.00031, 0, SIN, { 2, 1,-2, 1, 0, 0, 0 } },
  { -0.00027, 0, SIN, { 1, 1,-2, 1, 0, 1, 0 } },
  { -0.00024, 0, SIN, { 0, 1,-2, 1, 0, 1, 0 } },
  { -0.00021, 1, SIN, { 0, 1, 0, 1, 0, 0, 0 } },
  {  0.00018, 0, SIN, { 0, 1,-1, 1, 0, 0, 0 } },
  {  0.00016, 0, SIN, { 0, 1, 2, 0, 0, 0, 0 } },
  {  0.00016, 0, SIN, { 1,-1, 0,-1, 0,-1, 0 } },
  { -0.00016, 0, SIN, { 2,-1, 0,-1, 0, 0, 0 } },
  { -0.00015, 0, SIN, { 0, 1,-2, 0, 0, 1, 0 } },
  { -0.00012, 0, SIN, { 1,-1,-2,-1, 0, 1, 0 } },
  { -0.00011, 0, SIN, { 1,-1, 0,-1, 0, 1, 0 } },
  {  0.00009, 0, SIN, { 1, 1, 0, 1, 0,-1, 0 } },
  {  0.00009, 0, SIN, { 2, 1, 0, 0, 0, 0, 0 } },
  {  0.00008, 0, SIN, { 2,-1, 0, 0, 0, 0, 0 } },
  {  0.00008, 0, SIN, { 1, 1, 2, 1, 0, 0, 0 } },
  { -0.00008, 0, SIN, { 0, 3,-2, 1, 0, 0, 0 } },
  {  0.00007, 0, SIN, { 1,-1, 2, 0, 0, 0, 0 } },
  { -0.00007, 0, SIN, { 2,-1,-2,-1, 0, 0, 0 } },
  { -0.00007, 0, SIN, { 1, 1, 0, 1, 0, 1, 0 } },
  { -0.00006, 0, SIN, { 0, 1, 1, 1, 0, 0, 0 } },
  {  0.00006, 0, SIN, { 0, 1,-2, 0, 0,-1, 0 } },
  {  0.00006, 0, SIN, { 1,-1, 0, 1, 0, 0, 0 } },
  {  0.00006, 0, SIN, { 0, 1, 2, 1, 0,-1, 0 } },
  { -0.00005, 0, SIN, { 1, 1,-2, 0, 0, 1, 0 } },
  { -0.00004, 0, SIN, { 2, 1,-2, 0, 0, 0, 0 } },
  {  0.00004, 0, SIN, { 1,-3, 0,-1, 0, 0, 0 } },
  {  0.00004, 0, SIN, { 1,-1, 0, 0, 0,-1, 0 } },
  { -0.00003, 0, SIN, { 1,-1, 0, 0, 0, 1, 0 } },
  {  0.00003, 0, SIN, { 0, 1,-1, 0, 0, 0, 0 } },
  {  0.00003, 0, SIN, { 0, 1,-2, 1, 0,-1, 0 } },
  { -0.00003, 0, SIN, { 0, 1,-2,-1, 0, 0, 0 } },
  {  0.00003, 0, SIN, { 1, 1,-2, 1, 0,-1, 0 } },
  {  0.00003, 0, SIN, { 0, 1, 0, 0, 0,-1, 0 } },
  { -0.00003, 0, SIN, { 0, 1,-1, 1, 0,-1, 0 } },
  { -0.00002, 0, SIN, { 1,-1,-2, 0, 0, 1, 0 } },
  { -0.00002, 0, SIN, { 0, 1, 0, 0, 0, 1, 0 } },
  {  0.00002, 0, SIN, { 1, 1,-1, 1, 0, 0, 0 } },
  { -0.00002, 0, SIN, { 1, 1, 0,-1, 0, 0, 0 } },
  {  0.00002, 0, SIN, { 3, 1, 0, 1, 0, 0, 0 } },
  { -0.00002, 0, SIN, { 2,-1,-4,-1, 0, 0, 0 } },
  {  0.00002, 0, SIN, { 1,-1,-2,-1, 0,-1, 0 } },
  { -0.00002, 1, SIN, { 1,-1, 0,-1, 0, 0, 0 } },
  { -0.00002, 0, SIN, { 1,-1,-4,-1, 0, 0, 0 } },
  { -0.00002, 0, SIN, { 1,-1,-4, 0, 0, 0, 0 } },
  { -0.00002, 0, SIN, { 2,-1,-2, 0, 0, 0, 0 } },
  {  0.00002, 0, SIN, { 1, 1, 2, 0, 0, 0, 0 } },
  {  0.00002, 0, SIN, { 1, 1, 0, 0, 0,-1, 0 } } 
};

struct Term uMoon[31] = {
  {      0.0,30,   7, { 2, 3, 4, 5, 7, 8,12 } },
  {  1.00000, 0, COS, { 0, 0, 0, 0, 0, 0, 0 } },
  { -0.10828, 0, COS, { 1, 0, 0, 0, 0, 0, 0 } },
  { -0.01880, 0, COS, { 1, 0,-2, 0, 0, 0, 0 } },
  { -0.01479, 0, COS, { 0, 0, 2, 0, 0, 0, 0 } },
  {  0.00181, 0, COS, { 2, 0,-2, 0, 0, 0, 0 } },
  { -0.00147, 0, COS, { 2, 0, 0, 0, 0, 0, 0 } },
  { -0.00105, 0, COS, { 0, 0, 2, 0, 0,-1, 0 } },
  { -0.00075, 0, COS, { 1, 0,-2, 0, 0, 1, 0 } },
  { -0.00067, 0, COS, { 1, 0, 0, 0, 0,-1, 0 } },
  {  0.00057, 0, COS, { 0, 0, 1, 0, 0, 0, 0 } },
  {  0.00055, 0, COS, { 1, 0, 0, 0, 0, 1, 0 } },
  { -0.00046, 0, COS, { 1, 0, 2, 0, 0, 0, 0 } },
  {  0.00041, 0, COS, { 1,-2, 0, 0, 0, 0, 0 } },
  {  0.00024, 0, COS, { 0, 0, 0, 0, 0, 1, 0 } },
  {  0.00017, 0, COS, { 0, 0, 2, 0, 0, 1, 0 } },
  {  0.00013, 0, COS, { 1, 0,-2, 0, 0,-1, 0 } },
  { -0.00010, 0, COS, { 1, 0,-4, 0, 0, 0, 0 } },
  { -0.00009, 0, COS, { 0, 0, 1, 0, 0, 1, 0 } },
  {  0.00007, 0, COS, { 2, 0,-2, 0, 0, 1, 0 } },
  {  0.00006, 0, COS, { 3, 0,-2, 0, 0, 0, 0 } },
  {  0.00006, 0, COS, { 0, 2,-2, 0, 0, 0, 0 } },
  { -0.00005, 0, COS, { 0, 0, 2, 0, 0,-2, 0 } },
  { -0.00005, 0, COS, { 2, 0,-4, 0, 0, 0, 0 } },
  {  0.00005, 0, COS, { 1, 2,-2, 0, 0, 0, 0 } },
  { -0.00005, 0, COS, { 1, 0,-1, 0, 0, 0, 0 } },
  { -0.00004, 0, COS, { 1, 0, 2, 0, 0,-1, 0 } },
  { -0.00004, 0, COS, { 3, 0, 0, 0, 0, 0, 0 } },
  { -0.00003, 0, COS, { 1, 0,-4, 0, 0, 1, 0 } },
  { -0.00003, 0, COS, { 2,-2, 0, 0, 0, 0, 0 } },
  { -0.00003, 0, COS, { 0, 2, 0, 0, 0, 0, 0 } }
};

struct Term wMoon[79] = {
  {      0.0,78,   7, { 2, 3, 4, 5, 7, 8,12 } },
  {  0.10478, 0, SIN, { 1, 0, 0, 0, 0, 0, 0 } },
  { -0.04105, 0, SIN, { 0, 2, 0, 2, 0, 0, 0 } },
  { -0.02130, 0, SIN, { 1, 0,-2, 0, 0, 0, 0 } },
  { -0.01779, 0, SIN, { 0, 2, 0, 1, 0, 0, 0 } },
  {  0.01774, 0, SIN, { 0, 0, 0, 1, 0, 0, 0 } },
  {  0.00987, 0, SIN, { 0, 0, 2, 0, 0, 0, 0 } },
  { -0.00338, 0, SIN, { 1,-2, 0,-2, 0, 0, 0 } },
  { -0.00309, 0, SIN, { 0, 0, 0, 0, 0, 1, 0 } },
  { -0.00190, 0, SIN, { 0, 2, 0, 0, 0, 0, 0 } },
  { -0.00144, 0, SIN, { 1, 0, 0, 1, 0, 0, 0 } },
  { -0.00144, 0, SIN, { 1,-2, 0,-1, 0, 0, 0 } },
  { -0.00113, 0, SIN, { 1, 2, 0, 2, 0, 0, 0 } },
  { -0.00094, 0, SIN, { 1, 0,-2, 0, 0, 1, 0 } },
  { -0.00092, 0, SIN, { 2, 0,-2, 0, 0, 0, 0 } },
  {  0.00071, 0, SIN, { 0, 0, 2, 0, 0,-1, 0 } },
  {  0.00070, 0, SIN, { 2, 0, 0, 0, 0, 0, 0 } },
  {  0.00067, 0, SIN, { 1, 2,-2, 2, 0, 0, 0 } },
  {  0.00066, 0, SIN, { 0, 2,-2, 1, 0, 0, 0 } },
  { -0.00066, 0, SIN, { 0, 0, 2, 1, 0, 0, 0 } },
  {  0.00061, 0, SIN, { 1, 0, 0, 0, 0,-1, 0 } },
  { -0.00058, 0, SIN, { 0, 0, 1, 0, 0, 0, 0 } },
  { -0.00049, 0, SIN, { 1, 2, 0, 1, 0, 0, 0 } },
  { -0.00049, 0, SIN, { 1, 0, 0,-1, 0, 0, 0 } },
  { -0.00042, 0, SIN, { 1, 0, 0, 0, 0, 1, 0 } },
  {  0.00034, 0, SIN, { 0, 2,-2, 2, 0, 0, 0 } },
  { -0.00026, 0, SIN, { 0, 2,-2, 0, 0, 0, 0 } },
  {  0.00025, 0, SIN, { 1,-2,-2,-2, 0, 0, 0 } },
  {  0.00024, 0, SIN, { 1,-2, 0, 0, 0, 0, 0 } },
  {  0.00023, 0, SIN, { 1, 2,-2, 1, 0, 0, 0 } },
  {  0.00023, 0, SIN, { 1, 0,-2,-1, 0, 0, 0 } },
  {  0.00019, 0, SIN, { 1, 0, 2, 0, 0, 0, 0 } },
  {  0.00012, 0, SIN, { 1, 0,-2, 0, 0,-1, 0 } },
  {  0.00011, 0, SIN, { 1, 0,-2, 1, 0, 0, 0 } },
  {  0.00011, 0, SIN, { 1,-2,-2,-1, 0, 0, 0 } },
  { -0.00010, 0, SIN, { 0, 0, 2, 0, 0, 1, 0 } },
  {  0.00009, 0, SIN, { 1, 0,-1, 0, 0, 0, 0 } },
  {  0.00008, 0, SIN, { 0, 0, 1, 0, 0, 1, 0 } },
  { -0.00008, 0, SIN, { 0, 2, 2, 2, 0, 0, 0 } },
  { -0.00008, 0, SIN, { 0, 0, 0, 2, 0, 0, 0 } },
  { -0.00007, 0, SIN, { 0, 2, 0, 2, 0,-1, 0 } },
  {  0.00006, 0, SIN, { 0, 2, 0, 2, 0, 1, 0 } },
  { -0.00005, 0, SIN, { 1, 2, 0, 0, 0, 0, 0 } },
  {  0.00005, 0, SIN, { 3, 0, 0, 0, 0, 0, 0 } },
  { -0.00005, 0, SIN, { 1, 0, 0, 0,16, 0,-18} },
  { -0.00005, 0, SIN, { 2, 2, 0, 2, 0, 0, 0 } },
  {  0.00004, 1, SIN, { 0, 2, 0, 2, 0, 0, 0 } },
  {  0.00004, 0, COS, { 1, 0, 0, 0,16, 0,-18} },
  { -0.00004, 0, SIN, { 1,-2, 2, 0, 0, 0, 0 } },
  { -0.00004, 0, SIN, { 1, 0,-4, 0, 0, 0, 0 } },
  { -0.00004, 0, SIN, { 3, 0,-2, 0, 0, 0, 0 } },
  { -0.00004, 0, SIN, { 0, 2, 2, 1, 0, 0, 0 } },
  { -0.00004, 0, SIN, { 0, 0, 2,-1, 0, 0, 0 } },
  { -0.00003, 0, SIN, { 0, 0, 0, 0, 0, 2, 0 } },
  { -0.00003, 0, SIN, { 1, 0,-2, 0, 0, 2, 0 } },
  {  0.00003, 0, SIN, { 0, 2,-2, 1, 0, 1, 0 } },
  { -0.00003, 0, SIN, { 0, 0, 2, 1, 0,-1, 0 } },
  {  0.00003, 0, SIN, { 2, 2,-2, 2, 0, 0, 0 } },
  {  0.00003, 0, SIN, { 0, 0, 2, 0, 0,-2, 0 } },
  { -0.00003, 0, SIN, { 2, 0,-2, 0, 0, 1, 0 } },
  {  0.00003, 0, SIN, { 1, 2,-2, 2, 0, 1, 0 } },
  { -0.00003, 0, SIN, { 2, 0,-4, 0, 0, 0, 0 } },
  {  0.00002, 0, SIN, { 0, 2,-2, 2, 0, 1, 0 } },
  { -0.00002, 0, SIN, { 2, 2, 0, 1, 0, 0, 0 } },
  { -0.00002, 0, SIN, { 2, 0, 0,-1, 0, 0, 0 } },
  {  0.00002, 1, COS, { 1, 0, 0, 0,16, 0,-18} },
  {  0.00002, 0, SIN, { 0, 0, 4, 0, 0, 0, 0 } },
  { -0.00002, 0, SIN, { 0, 2,-1, 2, 0, 0, 0 } },
  { -0.00002, 0, SIN, { 1, 2,-2, 0, 0, 0, 0 } },
  { -0.00002, 0, SIN, { 2, 0, 0, 1, 0, 0, 0 } },
  { -0.00002, 0, SIN, { 2,-2, 0,-1, 0, 0, 0 } },
  {  0.00002, 0, SIN, { 1, 0, 2, 0, 0,-1, 0 } },
  {  0.00002, 0, SIN, { 2, 0, 0, 0, 0,-1, 0 } },
  { -0.00002, 0, SIN, { 1, 0,-4, 0, 0, 1, 0 } },
  {  0.00002, 1, SIN, { 1, 0, 0, 0,16, 0,-18} },
  { -0.00002, 0, SIN, { 1,-2, 0,-2, 0,-1, 0 } },
  {  0.00002, 0, SIN, { 2,-2, 0,-2, 0, 0, 0 } },
  { -0.00002, 0, SIN, { 1, 0, 2, 1, 0, 0, 0 } },
  { -0.00002, 0, SIN, { 1,-2, 2,-1, 0, 0, 0 } }
};
/*
struct Term plonJupiter[55] = {
  {      0.0,54,   7, { 5, 7, 8,18,19,22,25 } },
  {  19934.0, 0, SIN, { 0, 0, 0, 0, 1, 0, 0 } },
  {   5023.0, 1, COS, { 0, 0, 0, 0, 0, 0, 0 } },
  {   2511.0, 0, COS, { 0, 0, 0, 0, 0, 0, 0 } },
  {   1093.0, 0, COS, { 0, 0, 0, 0, 2,-5, 0 } },
  {    601.0, 0, SIN, { 0, 0, 0, 0, 2, 0, 0 } },
  {   -479.0, 0, SIN, { 0, 0, 0, 0, 2,-5, 0 } },
  {   -185.0, 0, SIN, { 0, 0, 0, 0, 2,-2, 0 } },
  {    137.0, 0, SIN, { 0, 0, 0, 0, 3,-5, 0 } },
  {   -131.0, 0, SIN, { 0, 0, 0, 0, 1,-2, 0 } },
  {     79.0, 0, COS, { 0, 0, 0, 0, 1,-1, 0 } },
  {    -76.0, 0, COS, { 0, 0, 0, 0, 2,-2, 0 } },
  {    -74.0, 1, COS, { 0, 0, 0, 0, 1, 0, 0 } },
  {     68.0, 1, SIN, { 0, 0, 0, 0, 1, 0, 0 } },
  {     66.0, 0, COS, { 0, 0, 0, 0, 2,-3, 0 } },
  {     63.0, 0, COS, { 0, 0, 0, 0, 3,-5, 0 } },
  {     53.0, 0, COS, { 0, 0, 0, 0, 1,-5, 0 } },
  {     49.0, 0, SIN, { 0, 0, 0, 0, 2,-3, 0 } },
  {    -43.0, 1, SIN, { 0, 0, 0, 0, 2,-5, 0 } },
  {    -37.0, 0, COS, { 0, 0, 0, 0, 1, 0, 0 } },
  {     25.0, 0, SIN, { 0, 0, 0, 2, 0, 0, 0 } },
  {     25.0, 0, SIN, { 0, 0, 0, 0, 3, 0, 0 } },
  {    -23.0, 0, SIN, { 0, 0, 0, 0, 1,-5, 0 } },
  {    -19.0, 1, COS, { 0, 0, 0, 0, 2,-5, 0 } },
  {     17.0, 0, COS, { 0, 0, 0, 0, 2,-4, 0 } },
  {     17.0, 0, COS, { 0, 0, 0, 0, 3,-3, 0 } },
  {    -14.0, 0, SIN, { 0, 0, 0, 0, 1,-1, 0 } },
  {    -13.0, 0, SIN, { 0, 0, 0, 0, 3,-4, 0 } },
  {     -9.0, 0, COS, { 0, 0, 0, 2, 0, 0, 0 } },
  {      9.0, 0, COS, { 0, 0, 0, 0, 0, 1, 0 } },
  {     -9.0, 0, SIN, { 0, 0, 0, 0, 0, 1, 0 } },
  {     -9.0, 0, SIN, { 0, 0, 0, 0, 3,-2, 0 } },
  {      9.0, 0, SIN, { 0, 0, 0, 0, 4,-5, 0 } },
  {      9.0, 0, SIN, { 0, 0, 0, 0, 2,-6, 3 } },
  {     -8.0, 0, COS, { 0, 0, 0, 0, 4,-10,0 } },
  {      7.0, 0, COS, { 0, 0, 0, 0, 3,-4, 0 } },
  {     -7.0, 0, COS, { 0, 0, 0, 0, 1,-3, 0 } },
  {     -7.0, 0, SIN, { 0, 0, 0, 0, 4,-10,0 } },
  {     -7.0, 0, SIN, { 0, 0, 0, 0, 1,-3, 0 } },
  {      6.0, 0, COS, { 0, 0, 0, 0, 4,-5, 0 } },
  {     -6.0, 0, SIN, { 0, 0, 0, 0, 3,-3, 0 } },
  {      5.0, 0, COS, { 0, 0, 0, 0, 0, 2, 0 } },
  {     -4.0, 0, SIN, { 0, 0, 0, 0, 4,-4, 0 } },
  {     -4.0, 0, COS, { 0, 0, 0, 0, 0, 3, 0 } },
  {      4.0, 0, COS, { 0, 0, 0, 0, 2,-1, 0 } },
  {     -4.0, 0, COS, { 0, 0, 0, 0, 3,-2, 0 } },
  {     -4.0, 1, COS, { 0, 0, 0, 0, 2, 0, 0 } },
  {      3.0, 1, SIN, { 0, 0, 0, 0, 2, 0, 0 } },
  {      3.0, 0, COS, { 0, 0, 0, 0, 0, 5, 0 } },
  {      3.0, 0, COS, { 0, 0, 0, 0, 5,-10,0 } },
  {      3.0, 0, SIN, { 0, 0, 0, 0, 0, 2, 0 } },
  {     -2.0, 0, SIN, { 0, 0, 0, 2,-1, 0, 0 } },
  {      2.0, 0, SIN, { 0, 0, 0, 2, 1, 0, 0 } },
  {     -2.0, 1, SIN, { 0, 0, 0, 0, 3,-5, 0 } },
  {     -2.0, 1, SIN, { 0, 0, 0, 0, 1,-5, 0 } }
};

struct Term betaJupiter[13] = {
  {      0.0,12,   7, { 5, 7, 8,18,19,22,25 } },
  {  -4692.0, 0, COS, { 0, 0, 0, 0, 1, 0, 0 } },
  {    259.0, 0, SIN, { 0, 0, 0, 0, 1, 0, 0 } },
  {    227.0, 0, COS, { 0, 0, 0, 0, 0, 0, 0 } },
  {   -227.0, 0, COS, { 0, 0, 0, 0, 2, 0, 0 } },
  {     30.0, 1, SIN, { 0, 0, 0, 0, 1, 0, 0 } },
  {     21.0, 1, COS, { 0, 0, 0, 0, 1, 0, 0 } },
  {     16.0, 0, SIN, { 0, 0, 0, 0, 3,-5, 0 } },
  {    -13.0, 0, SIN, { 0, 0, 0, 0, 1,-5, 0 } },
  {    -12.0, 0, COS, { 0, 0, 0, 0, 3, 0, 0 } },
  {     12.0, 0, SIN, { 0, 0, 0, 0, 2, 0, 0 } },
  {      7.0, 0, COS, { 0, 0, 0, 0, 3,-5, 0 } },
  {     -5.0, 0, COS, { 0, 0, 0, 0, 1,-5, 0 } }
};

struct Term rpJupiter[19] = {
  {      0.0,18,   7, { 5, 7, 8,18,19,22,25 } },
  {  5.20883, 0, COS, { 0, 0, 0, 0, 0, 0, 0 } },
  { -0.25122, 0, COS, { 0, 0, 0, 0, 1, 0, 0 } },
  { -0.00604, 0, COS, { 0, 0, 0, 0, 2, 0, 0 } },
  {  0.00260, 0, COS, { 0, 0, 0, 0, 2,-2, 0 } },
  { -0.00170, 0, COS, { 0, 0, 0, 0, 3,-5, 0 } },
  { -0.00106, 0, SIN, { 0, 0, 0, 0, 2,-2, 0 } },
  { -0.00091, 1, SIN, { 0, 0, 0, 0, 1, 0, 0 } },
  { -0.00084, 1, COS, { 0, 0, 0, 0, 1, 0, 0 } },
  {  0.00069, 0, SIN, { 0, 0, 0, 0, 2,-3, 0 } },
  { -0.00067, 0, SIN, { 0, 0, 0, 0, 1,-5, 0 } },
  {  0.00066, 0, SIN, { 0, 0, 0, 0, 3,-5, 0 } },
  {  0.00063, 0, SIN, { 0, 0, 0, 0, 1,-1, 0 } },
  { -0.00051, 0, COS, { 0, 0, 0, 0, 2,-3, 0 } },
  { -0.00046, 0, SIN, { 0, 0, 0, 0, 1, 0, 0 } },
  { -0.00029, 0, COS, { 0, 0, 0, 0, 1,-5, 0 } },
  {  0.00027, 0, COS, { 0, 0, 0, 0, 1,-2, 0 } },
  { -0.00022, 0, COS, { 0, 0, 0, 0, 3, 0, 0 } },
  { -0.00021, 0, SIN, { 0, 0, 0, 0, 2,-5, 0 } },
};
*/
struct Term vJupiter[62] = {
  {      0.0,61,   7, { 5, 7, 8,18,19,22,25 } },
  {  0.38966, 0, SIN, { 0, 0, 0, 1, 0, 0, 0 } },
  {  0.07498, 0, SIN, { 0, 1, 0, 0, 0, 0, 0 } },
  { -0.02828, 0, SIN, { 0, 0, 0, 1,-1, 0, 0 } },
  { -0.02049, 0, COS, { 0, 0, 0, 0, 1, 0, 0 } },
  {  0.00948, 1, COS, { 0, 0, 0, 1, 0, 0, 0 } },
  {  0.00942, 0, SIN, { 0, 0, 0, 1, 1, 0, 0 } },
  {  0.00472, 0, COS, { 0, 0, 0, 1, 0, 0, 0 } },
  { -0.00188, 0, SIN, { 0, 1,-1, 0, 0, 0, 0 } },
  {  0.00149, 0, COS, { 0, 0, 0, 0, 0, 0, 0 } },
  {  0.00113, 0, SIN, { 0, 0, 0, 0, 1, 0, 0 } },
  {  0.00103, 0, COS, { 0, 0, 0, 1, 2,-5, 0 } },
  {  0.00103, 0, COS, { 0, 0, 0, 1,-2, 5, 0 } },
  { -0.00079, 1, COS, { 0, 0, 0, 1,-1, 0, 0 } },
  {  0.00063, 0, SIN, { 0, 1, 1, 0, 0, 0, 0 } },
  { -0.00049, 0, COS, { 0, 0, 0, 0, 2, 0, 0 } },
  { -0.00047, 0, SIN, { 0, 0, 0, 1, 2,-5, 0 } },
  {  0.00043, 0, SIN, { 0, 0, 0, 1,-2, 5, 0 } },
  { -0.00040, 0, COS, { 0, 0, 0, 1,-1, 0, 0 } },
  { -0.00033, 1, SIN, { 0, 0, 0, 1, 0, 0, 0 } },
  {  0.00032, 0, SIN, { 0, 0, 0, 1, 2, 0, 0 } },
  {  0.00026, 0, SIN, { 0, 0, 0, 1,-2, 2, 0 } },
  { -0.00023, 0, SIN, { 0, 0, 0, 1,-3, 5, 0 } },
  {  0.00019, 1, COS, { 0, 0, 0, 1, 1, 0, 0 } },
  {  0.00014, 0, SIN, { 0, 0, 0, 1,-1, 2, 0 } },
  {  0.00013, 1, SIN, { 0, 0, 0, 0, 1, 0, 0 } },
  { -0.00012, 2, SIN, { 0, 0, 0, 1, 0, 0, 0 } },
  { -0.00011, 0, COS, { 0, 0, 0, 1,-2, 2, 0 } },
  { -0.00011, 0, SIN, { 0, 0, 0, 1, 1,-2, 0 } },
  {  0.00010, 0, COS, { 0, 0, 0, 1,-1, 1, 0 } },
  {  0.00010, 0, COS, { 0, 0, 0, 1, 1, 0, 0 } },
  {  0.00009, 1, COS, { 0, 0, 0, 0, 1, 0, 0 } },
  {  0.00009, 0, SIN, { 0, 0, 0, 1,-2, 0, 0 } },
  {  0.00009, 0, COS, { 0, 0, 0, 1,-2, 3, 0 } },
  { -0.00008, 0, SIN, { 0, 0, 0, 1, 2,-2, 0 } },
  { -0.00007, 1, SIN, { 0, 0, 0, 1,-1, 0, 0 } },
  {  0.00007, 0, SIN, { 0, 0, 0, 0, 3,-5, 0 } },
  { -0.00007, 0, SIN, { 0, 0, 0, 1,-2, 3, 0 } },
  { -0.00007, 1, SIN, { 0, 0, 0, 1, 2,-5, 0 } },
  {  0.00006, 0, COS, { 0, 0, 0, 1, 3,-5, 0 } },
  { -0.00006, 0, SIN, { 0, 0, 0, 0, 1,-5, 0 } },
  {  0.00005, 0, SIN, { 0, 0, 0, 1, 3,-5, 0 } },
  {  0.00005, 0, COS, { 0, 0, 0, 1, 1,-1, 0 } },
  {  0.00005, 0, COS, { 0, 0, 0, 1,-1, 5, 0 } },
  { -0.00004, 0, COS, { 0, 1, 0, 0, 0, 0, 0 } },
  { -0.00004, 1, SIN, { 0, 1, 0, 0, 0, 0, 0 } },
  { -0.00004, 0, SIN, { 1, 0, 0,-1, 0, 0, 0 } },
  {  0.00004, 0, COS, { 0, 0, 0, 1, 2,-3, 0 } },
  { -0.00003, 0, COS, { 0, 0, 0, 1, 2,-2, 0 } },
  { -0.00003, 1, COS, { 0, 0, 0, 1, 2,-5, 0 } },
  {  0.00003, 0, COS, { 0, 0, 0, 0, 3,-5, 0 } },
  {  0.00003, 0, SIN, { 0, 0, 0, 1, 2,-3, 0 } },
  {  0.00003, 0, SIN, { 0, 0, 0, 0, 2, 0, 0 } },
  {  0.00003, 1, SIN, { 0, 0, 0, 1, 1, 0, 0 } },
  {  0.00002, 0, SIN, { 0, 0, 0, 3, 0, 0, 0 } },
  {  0.00002, 0, COS, { 0, 0, 0, 1,-3, 3, 0 } },
  {  0.00002, 0, SIN, { 0, 0, 0, 1,-1, 5, 0 } },
  { -0.00002, 0, COS, { 0, 0, 0, 0, 1,-5, 0 } },
  { -0.00002, 0, COS, { 0, 0, 0, 0, 3, 0, 0 } },
  {  0.00002, 0, COS, { 0, 0, 0, 1, 2,-4, 0 } },
  {  0.00002, 0, COS, { 0, 0, 0, 1,-2, 4, 0 } },
  {  0.00002, 1, SIN, { 0, 0, 0, 1,-2, 5, 0 } }
};

struct Term uJupiter[69] = {
  {      0.0,68,   7, { 5, 7, 8,18,19,22,25 } },
  {  1.00000, 0, COS, { 0, 0, 0, 0, 0, 0, 0 } },
  {  0.36891, 0, COS, { 0, 1, 0,-1, 0, 0, 0 } },
  { -0.09288, 0, COS, { 0, 0, 0, 0, 1, 0, 0 } },
  { -0.02678, 0, COS, { 0, 1, 0,-1, 1, 0, 0 } },
  { -0.00927, 0, COS, { 0, 1,-1,-1, 0, 0, 0 } },
  {  0.00898, 1, SIN, { 0, 1, 0,-1, 0, 0, 0 } },
  {  0.00892, 0, COS, { 0, 1, 0,-1,-1, 0, 0 } },
  {  0.00467, 0, SIN, { 0, 1, 0,-1, 0, 0, 0 } },
  {  0.00309, 0, COS, { 0, 1, 1,-1, 0, 0, 0 } },
  { -0.00119, 0, COS, { 0, 0, 1, 0, 0, 0, 0 } },
  { -0.00111, 0, COS, { 0, 0, 0, 0, 2, 0, 0 } },
  {  0.00098, 0, SIN, { 0, 1, 0,-1,-2, 5, 0 } },
  {  0.00098, 0, SIN, { 0, 1, 0,-1, 2,-5, 0 } },
  {  0.00096, 0, COS, { 0, 0, 0, 0, 2,-2, 0 } },
  { -0.00075, 1, SIN, { 0, 1, 0,-1, 1, 0, 0 } },
  {  0.00067, 0, COS, { 0, 1,-1,-1, 1, 0, 0 } },
  { -0.00063, 0, COS, { 0, 0, 0, 0, 3,-5, 0 } },
  { -0.00045, 0, COS, { 0, 1, 0,-1,-2, 5, 0 } },
  {  0.00041, 0, COS, { 0, 1, 0,-1, 2,-5, 0 } },
  { -0.00040, 0, SIN, { 0, 0, 0, 0, 2,-2, 0 } },
  { -0.00039, 0, SIN, { 0, 1, 0,-1, 1, 0, 0 } },
  { -0.00035, 1, SIN, { 0, 0, 0, 0, 1, 0, 0 } },
  { -0.00032, 1, COS, { 0, 0, 0, 0, 1, 0, 0 } },
  {  0.00030, 0, COS, { 0, 1, 0,-1,-2, 0, 0 } },
  {  0.00025, 0, SIN, { 0, 0, 0, 0, 2,-3, 0 } },
  {  0.00025, 0, COS, { 0, 1, 0,-1, 2,-2, 0 } },
  { -0.00024, 0, SIN, { 0, 0, 0, 0, 1,-5, 0 } },
  {  0.00024, 0, SIN, { 0, 0, 0, 0, 3,-5, 0 } },
  {  0.00023, 0, SIN, { 0, 0, 0, 0, 1,-1, 0 } },
  { -0.00023, 1, SIN, { 0, 1,-1,-1, 0, 0, 0 } },
  { -0.00022, 0, COS, { 0, 1, 1,-1, 1, 0, 0 } },
  { -0.00022, 0, COS, { 0, 1,-1,-1,-1, 0, 0 } },
  { -0.00021, 0, COS, { 0, 1, 0,-1, 3,-5, 0 } },
  { -0.00019, 0, COS, { 0, 0, 0, 0, 2,-3, 0 } },
  {  0.00018, 1, SIN, { 0, 1, 0,-1,-1, 0, 0 } },
  { -0.00017, 0, SIN, { 0, 0, 0, 0, 1, 0, 0 } },
  {  0.00014, 0, COS, { 0, 1, 0,-1, 1,-2, 0 } },
  { -0.00011, 1, COS, { 0, 1, 0,-1, 0, 0, 0 } },
  { -0.00011, 0, SIN, { 0, 1,-1,-1, 0, 0, 0 } },
  { -0.00011, 2, COS, { 0, 1, 0,-1, 0, 0, 0 } },
  { -0.00011, 0, COS, { 0, 0, 0, 0, 1,-5, 0 } },
  { -0.00010, 0, SIN, { 0, 1, 0,-1, 2,-2, 0 } },
  {  0.00010, 0, SIN, { 0, 0, 0, 0, 3,-3, 0 } },
  { -0.00010, 0, COS, { 0, 1, 0,-1,-1, 2, 0 } },
  {  0.00009, 0, SIN, { 0, 1, 0,-1, 1,-1, 0 } },
  {  0.00009, 0, SIN, { 0, 1, 0,-1,-1, 0, 0 } },
  {  0.00009, 0, COS, { 0, 0, 0, 0, 1,-2, 0 } },
  {  0.00009, 0, COS, { 0, 1, 0,-1, 2, 0, 0 } },
  {  0.00008, 0, SIN, { 0, 1, 0,-1, 2,-3, 0 } },
  { -0.00008, 1, COS, { 0, 1, 0,-1, 1, 0, 0 } },
  {  0.00008, 1, SIN, { 0, 1, 1,-1, 0, 0, 0 } },
  { -0.00008, 0, COS, { 0, 1, 0,-1,-2, 2, 0 } },
  {  0.00007, 0, COS, { 0, 1, 1,-1,-1, 0, 0 } },
  { -0.00007, 0, SIN, { 0, 0, 0, 0, 2,-5, 0 } },
  { -0.00006, 0, COS, { 0, 0, 0, 0, 0, 2, 0 } },
  { -0.00006, 0, COS, { 0, 1, 0,-1, 2,-3, 0 } },
  { -0.00006, 1, COS, { 0, 1, 0,-1,-2, 5, 0 } },
  {  0.00006, 0, SIN, { 0, 1, 0,-1,-3, 5, 0 } },
  {  0.00005, 0, COS, { 0, 1, 0,-1,-3, 5, 0 } },
  {  0.00005, 0, SIN, { 0, 1, 0,-1,-1, 1, 0 } },
  {  0.00005, 0, SIN, { 0, 1, 0,-1, 1,-5, 0 } },
  {  0.00005, 0, COS, { 0, 0, 0, 0, 3,-3, 0 } },
  {  0.00004, 0, SIN, { 0, 0, 0, 0, 1,-2, 0 } },
  {  0.00004, 0, COS, { 0, 1, 2,-1, 0, 0, 0 } },
  {  0.00004, 0, SIN, { 0, 1, 1,-1, 0, 0, 0 } },
  {  0.00003, 0, SIN, { 0, 0, 0, 0, 0, 1, 0 } },
  {  0.00003, 0, SIN, { 0, 1, 0,-1,-2, 3, 0 } },
  { -0.00003, 0, SIN, { 0, 0, 0, 0, 1,-3, 0 } }
};

struct Term wJupiter[77] = {
  {      0.0,76,   7, { 5, 7, 8,18,19,22,25 } },
  {  0.18063, 0, SIN, { 0, 1, 0,-1, 0, 0, 0 } },
  {  0.09081, 0, SIN, { 0, 0, 0, 0, 1, 0, 0 } },
  { -0.04032, 0, SIN, { 0, 0, 0, 2, 0, 0, 0 } },
  {  0.02286, 1, COS, { 0, 0, 0, 0, 0, 0, 0 } },
  {  0.01138, 0, COS, { 0, 0, 0, 0, 0, 0, 0 } },
  { -0.00778, 0, SIN, { 0, 1, 0, 1, 0, 0, 0 } },
  {  0.00497, 0, COS, { 0, 0, 0, 0, 2,-5, 0 } },
  { -0.00454, 0, SIN, { 0, 1,-1,-1, 0, 0, 0 } },
  {  0.00445, 0, COS, { 0, 0, 0, 1, 1, 0, 0 } },
  {  0.00445, 0, COS, { 0, 0, 0, 1,-1, 0, 0 } },
  {  0.00293, 0, SIN, { 0, 0, 0, 2,-1, 0, 0 } },
  { -0.00218, 0, SIN, { 0, 0, 0, 0, 2,-5, 0 } },
  {  0.00151, 0, SIN, { 0, 1, 1,-1, 0, 0, 0 } },
  { -0.00144, 1, COS, { 0, 0, 0, 0, 1, 0, 0 } },
  { -0.00099, 1, COS, { 0, 0, 0, 2, 0, 0, 0 } },
  { -0.00097, 0, SIN, { 0, 0, 0, 2, 1, 0, 0 } },
  { -0.00083, 0, SIN, { 0, 0, 0, 0, 2,-2, 0 } },
  { -0.00072, 0, COS, { 0, 0, 0, 0, 1, 0, 0 } },
  {  0.00067, 0, SIN, { 0, 0, 0, 0, 3,-5, 0 } },
  { -0.00064, 0, COS, { 0, 0, 0, 1, 0, 0, 0 } },
  { -0.00060, 0, SIN, { 0, 0, 0, 0, 1,-2, 0 } },
  {  0.00054, 0, SIN, { 0, 0, 0, 0, 2, 0, 0 } },
  { -0.00053, 0, COS, { 0, 0, 0, 2, 0, 0, 0 } },
  {  0.00036, 0, COS, { 0, 0, 0, 0, 1,-1, 0 } },
  { -0.00034, 0, COS, { 0, 0, 0, 0, 2,-2, 0 } },
  {  0.00030, 0, COS, { 0, 0, 0, 0, 2,-3, 0 } },
  {  0.00028, 1, SIN, { 0, 0, 0, 0, 1, 0, 0 } },
  { -0.00025, 0, SIN, { 0, 0, 0, 1, 1, 0, 0 } },
  {  0.00025, 0, SIN, { 0, 0, 0, 1,-1, 0, 0 } },
  {  0.00022, 0, SIN, { 0, 0, 0, 0, 2,-3, 0 } },
  { -0.00020, 1, SIN, { 0, 0, 0, 0, 2,-5, 0 } },
  {  0.00020, 0, SIN, { 0, 1,-1, 1, 0, 0, 0 } },
  {  0.00016, 0, COS, { 0, 0, 0, 0, 3,-5, 0 } },
  {  0.00012, 0, COS, { 0, 0, 0, 0, 1,-5, 0 } },
  {  0.00011, 0, COS, { 0, 0, 0, 1, 2, 0, 0 } },
  {  0.00011, 0, COS, { 0, 0, 0, 1,-2, 0, 0 } },
  { -0.00011, 0, COS, { 0, 0, 0, 2, 2,-5, 0 } },
  { -0.00011, 0, COS, { 0, 0, 0, 2,-2, 5, 0 } },
  { -0.00010, 0, COS, { 0, 1, 0,-1, 0, 0, 0 } },
  { -0.00009, 1, COS, { 0, 0, 0, 0, 2,-5, 0 } },
  {  0.00008, 1, COS, { 0, 0, 0, 2,-1, 0, 0 } },
  { -0.00008, 0, SIN, { 1, 0, 0, 0, 0, 0, 0 } },
  {  0.00008, 0, COS, { 0, 0, 0, 0, 2,-4, 0 } },
  { -0.00007, 0, SIN, { 0, 0, 0, 0, 1,-1, 0 } },
  { -0.00007, 0, SIN, { 0, 1, 1, 1, 0, 0, 0 } },
  {  0.00006, 0, COS, { 0, 0, 0, 0, 3,-3, 0 } },
  { -0.00006, 0, SIN, { 0, 0, 0, 0, 3,-4, 0 } },
  {  0.00006, 1, SIN, { 0, 0, 0, 2, 0, 0, 0 } },
  { -0.00005, 0, SIN, { 0, 0, 0, 0, 1,-5, 0 } },
  {  0.00005, 0, SIN, { 0, 0, 0, 2, 2,-5, 0 } },
  { -0.00004, 0, SIN, { 0, 0, 0, 2,-2, 5, 0 } },
  {  0.00004, 0, COS, { 0, 0, 0, 2,-1, 0, 0 } },
  { -0.00004, 0, SIN, { 0, 0, 0, 0, 0, 1, 0 } },
  {  0.00004, 0, SIN, { 0, 0, 0, 0, 2,-6, 3 } },
  {  0.00004, 0, COS, { 0, 0, 0, 0, 0, 1, 0 } },
  { -0.00004, 0, COS, { 0, 0, 0, 0, 4,-10,0 } },
  { -0.00004, 0, SIN, { 0, 0, 0, 0, 1,-3, 0 } },
  { -0.00003, 0, COS, { 0, 0, 0, 0, 1,-3, 0 } },
  {  0.00003, 0, COS, { 0, 0, 0, 0, 3,-4, 0 } },
  { -0.00003, 0, SIN, { 0, 0, 0, 0, 4,-10,0 } },
  { -0.00003, 0, SIN, { 0, 0, 0, 2, 2, 0, 0 } },
  {  0.00003, 1, COS, { 0, 0, 0, 0, 2, 0, 0 } },
  { -0.00003, 1, SIN, { 0, 0, 0, 1, 1, 0, 0 } },
  {  0.00003, 1, SIN, { 0, 0, 0, 1,-1, 0, 0 } },
  { -0.00003, 0, SIN, { 0, 0, 0, 0, 3,-3, 0 } },
  { -0.00003, 0, SIN, { 0, 0, 0, 2,-2, 2, 0 } },
  {  0.00002, 0, COS, { 0, 0, 0, 0, 0, 2, 0 } },
  {  0.00002, 0, SIN, { 0, 0, 0, 2,-3, 5, 0 } },
  { -0.00002, 1, COS, { 0, 0, 0, 1, 1, 0, 0 } },
  { -0.00002, 1, COS, { 0, 0, 0, 1,-1, 0, 0 } },
  { -0.00002, 2, SIN, { 0, 0, 0, 0, 1, 0, 0 } },
  { -0.00002, 1, COS, { 0, 0, 0, 2, 1, 0, 0 } },
  {  0.00002, 0, SIN, { 0, 1, 2,-1, 0, 0, 0 } },
  { -0.00002, 0, SIN, { 0, 0, 0, 0, 4,-4, 0 } },
  {  0.00002, 1, COS, { 0, 0, 0, 0, 2,-2, 0 } },
  {  0.00002, 0, SIN, { 0, 0, 0, 0, 3, 0, 0 } }
};

struct Term vSaturn[87] = {
  {      0.0,86,   7, { 5, 7, 8,19,21,22,25 } },
  {  0.39412, 0, SIN, { 0, 0, 0, 0, 1, 0, 0 } },
  {  0.04138, 0, SIN, { 0, 1, 0, 0, 0, 0, 0 } },
  {  0.03664, 0, SIN, { 0, 0, 0, 0, 0, 1, 0 } },
  { -0.03310, 0, SIN, { 0, 0, 0, 0, 1,-1, 0 } },
  { -0.01480, 0, COS, { 0, 0, 0, 0, 0, 1, 0 } },
  {  0.01099, 0, SIN, { 0, 0, 0, 0, 1, 1, 0 } },
  {  0.00957, 1, COS, { 0, 0, 0, 0, 1, 0, 0 } },
  {  0.00471, 0, COS, { 0, 0, 0, 0, 1, 0, 0 } },
  { -0.00259, 0, COS, { 0, 0, 0, 2, 1,-5, 0 } },
  { -0.00255, 0, COS, { 0, 0, 0, 2,-1,-5, 0 } },
  {  0.00123, 0, COS, { 0, 0, 0, 0, 0, 0, 0 } },
  {  0.00118, 0, SIN, { 0, 0, 0, 2, 1,-5, 0 } },
  { -0.00113, 1, COS, { 0, 0, 0, 0, 1,-1, 0 } },
  {  0.00107, 0, SIN, { 0, 0, 0, 2,-1,-5, 0 } },
  { -0.00104, 0, SIN, { 0, 1,-1, 0, 0, 0, 0 } },
  {  0.00102, 0, SIN, { 0, 0, 0, 0, 0, 2, 0 } },
  { -0.00096, 0, COS, { 0, 0, 0, 2,-1,-4, 0 } },
  { -0.00056, 0, COS, { 0, 0, 0, 0, 1,-1, 0 } },
  {  0.00053, 0, SIN, { 0, 0, 0, 0, 1, 2, 0 } },
  {  0.00051, 0, SIN, { 0, 0, 0, 1,-1,-2, 0 } },
  { -0.00048, 0, COS, { 0, 0, 0, 2, 1,-4, 0 } },
  { -0.00042, 0, COS, { 0, 0, 0, 0, 0, 2, 0 } },
  {  0.00035, 1, COS, { 0, 0, 0, 0, 0, 1, 0 } },
  {  0.00035, 0, SIN, { 0, 1, 1, 0, 0, 0, 0 } },
  { -0.00032, 1, SIN, { 0, 0, 0, 0, 1, 0, 0 } },
  { -0.00032, 0, COS, { 0, 0, 0, 2, 0,-4, 0 } },
  {  0.00029, 0, SIN, { 0, 0, 0, 1, 1,-2, 0 } },
  {  0.00024, 1, SIN, { 0, 0, 0, 0, 1,-1, 0 } },
  {  0.00022, 0, SIN, { 0, 0, 0, 0, 1,-2, 0 } },
  {  0.00020, 0, SIN, { 0, 0, 0, 2, 0,-6, 0 } },
  { -0.00019, 0, COS, { 0, 0, 0, 2, 0,-6, 0 } },
  { -0.00017, 0, COS, { 0, 0, 0, 1, 1,-1, 0 } },
  {  0.00017, 0, COS, { 0, 0, 0, 1,-1,-1, 0 } },
  {  0.00016, 1, COS, { 0, 0, 0, 0, 1, 1, 0 } },
  {  0.00016, 1, SIN, { 0, 0, 0, 2, 1,-5, 0 } },
  { -0.00015, 0, COS, { 0, 0, 0, 2,-1,-6, 0 } },
  { -0.00012, 0, SIN, { 0, 0, 0, 2,-1,-4, 0 } },
  { -0.00012, 2, SIN, { 0, 0, 0, 0, 1, 0, 0 } },
  { -0.00009, 0, COS, { 0, 0, 0, 2, 0,-5, 0 } },
  {  0.00009, 1, COS, { 0, 0, 0, 2, 1,-5, 0 } },
  {  0.00009, 1, SIN, { 0, 0, 0, 0, 0, 1, 0 } },
  {  0.00008, 0, COS, { 0, 0, 0, 0, 1, 1, 0 } },
  { -0.00007, 1, SIN, { 0, 0, 0, 0, 1, 1, 0 } },
  {  0.00007, 0, COS, { 0, 0, 0, 0, 1,-2, 0 } },
  { -0.00007, 0, COS, { 0, 0, 0, 0, 1, 2, 0 } },
  { -0.00007, 1, COS, { 0, 0, 0, 0, 0, 0, 0 } },
  { -0.00007, 0, COS, { 0, 0, 0, 0, 3, 0, 0 } },
  {  0.00006, 0, SIN, { 0, 0, 0, 0, 3, 0, 0 } },
  {  0.00006, 0, SIN, { 0, 0, 0, 2,-1,-6, 0 } },
  {  0.00006, 0, SIN, { 0, 0, 0, 1, 1,-1, 0 } },
  {  0.00006, 0, COS, { 0, 0, 0, 2,-1,-3, 0 } },
  {  0.00006, 0, SIN, { 0, 0, 0, 2,-1,-2, 0 } },
  {  0.00005, 0, SIN, { 0, 0, 0, 1, 0,-3, 0 } },
  {  0.00004, 0, SIN, { 0, 0, 0, 0, 0, 3, 0 } },
  { -0.00004, 0, COS, { 0, 0, 0, 2, 0,-3, 0 } },
  {  0.00004, 0, SIN, { 0, 0, 0, 2,-1,-3, 0 } },
  { -0.00004, 0, COS, { 0, 1, 0, 0, 0, 0, 0 } },
  {  0.00004, 0, SIN, { 0, 0, 0, 1,-1,-3, 0 } },
  { -0.00004, 0, SIN, { 1, 0, 0, 0,-1, 0, 0 } },
  {  0.00004, 1, SIN, { 0, 0, 0, 2,-1,-5, 0 } },
  {  0.00003, 0, COS, { 0, 0, 0, 1, 1,-3, 0 } },
  {  0.00003, 0, SIN, { 0, 0, 0, 2, 1,-4, 0 } },
  {  0.00003, 0, SIN, { 0, 0, 0, 0, 1, 3, 0 } },
  {  0.00003, 1, SIN, { 0, 0, 0, 2, 1,-4, 0 } },
  {  0.00003, 0, SIN, { 0, 0, 0, 1, 1,-3, 0 } },
  { -0.00003, 0, SIN, { 0, 0, 0, 1,-1,-1, 0 } },
  {  0.00003, 1, COS, { 0, 0, 0, 2,-1,-5, 0 } },
  { -0.00003, 0, COS, { 0, 0, 0, 2, 1,-3, 0 } },
  { -0.00003, 0, SIN, { 0, 0, 0, 2, 1,-6, 3 } },
  { -0.00003, 0, SIN, { 0, 0, 0, 2,-1,-6, 3 } },
  {  0.00003, 0, COS, { 0, 0, 0, 0, 1,-2, 3 } },
  {  0.00003, 0, SIN, { 0, 0, 0, 1, 0,-1, 0 } },
  {  0.00003, 0, COS, { 0, 0, 0, 4,-1,-10,0 } },
  {  0.00003, 0, SIN, { 0, 0, 0, 2, 0,-5, 0 } },
  {  0.00003, 0, SIN, { 0, 0, 0, 4,-1,-10,0 } },
  { -0.00002, 1, SIN, { 0, 1, 0, 0, 0, 0, 0 } },
  {  0.00002, 0, SIN, { 0, 0, 0, 0, 1,-1, 3 } },
  { -0.00002, 0, SIN, { 0, 0, 0, 0, 1, 1,-3 } },
  {  0.00002, 0, COS, { 0, 0, 0, 1, 0,-3, 0 } },
  {  0.00002, 0, COS, { 0, 0, 0, 1,-1,-3, 0 } },
  { -0.00002, 0, COS, { 0, 0, 0, 0, 0, 3, 0 } },
  {  0.00002, 2, SIN, { 0, 0, 0, 0, 1,-1, 0 } },
  {  0.00002, 0, COS, { 0, 0, 0, 2,-1,-2, 0 } },
  { -0.00002, 0, COS, { 0, 0, 0, 0, 1,-1, 3 } },
  { -0.00002, 0, COS, { 0, 0, 0, 0, 1, 1,-3 } },
  {  0.00002, 0, SIN, { 0, 0, 0, 4,-1,-9, 0 } }
};

struct Term uSaturn[84] = {
  {      0.0,83,   7, { 5, 7, 8,19,21,22,25 } },
  {  1.00000, 0, COS, { 0, 0, 0, 0, 0, 0, 0 } },
  {  0.20588, 0, COS, { 0, 1, 0, 0,-1, 0, 0 } },
  { -0.10998, 0, COS, { 0, 0, 0, 0, 0, 1, 0 } },
  { -0.01729, 0, COS, { 0, 1, 0, 0,-1, 1, 0 } },
  {  0.00574, 0, COS, { 0, 1, 0, 0,-1,-1, 0 } },
  { -0.00517, 0, COS, { 0, 1,-1, 0,-1, 0, 0 } },
  {  0.00500, 1, SIN, { 0, 1, 0, 0,-1, 0, 0 } },
  { -0.00389, 0, SIN, { 0, 0, 0, 2, 0,-4, 0 } },
  {  0.00269, 0, SIN, { 0, 1, 0, 0,-1, 0, 0 } },
  {  0.00172, 0, COS, { 0, 1, 1, 0,-1, 0, 0 } },
  {  0.00168, 0, SIN, { 0, 0, 0, 1, 0,-1, 0 } },
  { -0.00153, 0, COS, { 0, 0, 0, 0, 0, 2, 0 } },
  { -0.00135, 0, SIN, { 0, 1, 0,-2,-1, 5, 0 } },
  { -0.00133, 0, SIN, { 0, 1, 0, 2,-1,-5, 0 } },
  { -0.00113, 0, COS, { 0, 0, 0, 1, 0,-2, 0 } },
  { -0.00109, 1, SIN, { 0, 0, 0, 0, 0, 1, 0 } },
  {  0.00081, 0, SIN, { 0, 0, 0, 2, 0,-5, 0 } },
  {  0.00070, 0, SIN, { 0, 0, 0, 2, 0,-6, 0 } },
  {  0.00067, 1, COS, { 0, 0, 0, 0, 0, 1, 0 } },
  {  0.00062, 0, COS, { 0, 1, 0,-2,-1, 5, 0 } },
  { -0.00059, 1, SIN, { 0, 1, 0, 0,-1, 1, 0 } },
  { -0.00056, 0, COS, { 0, 1, 0, 2,-1,-5, 0 } },
  { -0.00051, 0, SIN, { 0, 0, 0, 0, 0, 1, 0 } },
  { -0.00050, 0, SIN, { 0, 1, 0, 2,-1,-4, 0 } },
  {  0.00043, 0, COS, { 0, 1,-1, 0,-1, 1, 0 } },
  { -0.00036, 0, COS, { 0, 0, 1, 0, 0, 0, 0 } },
  {  0.00033, 0, COS, { 0, 0, 0, 2, 0,-6, 0 } },
  { -0.00031, 0, SIN, { 0, 1, 0, 0,-1, 1, 0 } },
  { -0.00028, 0, COS, { 0, 0, 0, 2, 0,-2, 0 } },
  {  0.00027, 0, COS, { 0, 1, 0, 0,-1,-2, 0 } },
  { -0.00027, 0, COS, { 0, 1, 0, 1,-1,-2, 0 } },
  { -0.00025, 0, SIN, { 0, 1, 0,-2,-1, 4, 0 } },
  {  0.00025, 0, COS, { 0, 0, 0, 1, 0,-1, 0 } },
  {  0.00022, 0, COS, { 0, 0, 0, 1, 0,-3, 0 } },
  {  0.00019, 0, COS, { 0, 0, 0, 2, 0,-5, 0 } },
  {  0.00015, 0, COS, { 0, 1, 0,-1,-1, 2, 0 } },
  { -0.00014, 0, COS, { 0, 1, 1, 0,-1, 1, 0 } },
  { -0.00014, 0, COS, { 0, 1,-1, 0,-1,-1, 0 } },
  { -0.00014, 0, COS, { 0, 0, 0, 2, 0,-3, 0 } },
  { -0.00013, 1, SIN, { 0, 1,-1, 0,-1, 0, 0 } },
  {  0.00012, 0, COS, { 0, 1, 0, 0,-1, 2, 0 } },
  {  0.00012, 1, COS, { 0, 1, 0, 0,-1, 1, 0 } },
  { -0.00009, 0, SIN, { 0, 1, 0,-1,-1, 1, 0 } },
  {  0.00009, 0, SIN, { 0, 1, 0, 1,-1,-1, 0 } },
  {  0.00009, 0, COS, { 0, 0, 0, 2, 0,-4, 0 } },
  {  0.00009, 0, SIN, { 0, 0, 0, 0, 0, 2,-3 } },
  {  0.00008, 1, SIN, { 0, 1, 0, 0,-1,-1, 0 } },
  {  0.00008, 1, COS, { 0, 1, 0,-2,-1, 5, 0 } },
  { -0.00008, 0, SIN, { 0, 0, 0, 1, 0, 0, 0 } },
  { -0.00008, 1, COS, { 0, 0, 0, 0, 0, 0, 0 } },
  { -0.00008, 0, SIN, { 0, 1, 0, 2,-1,-6, 0 } },
  {  0.00007, 0, SIN, { 0, 0, 0, 2, 0,-2, 0 } },
  {  0.00007, 0, SIN, { 0, 0, 0, 2, 0,-3, 0 } },
  { -0.00006, 0, SIN, { 0, 0, 0, 1, 0,-3, 0 } },
  {  0.00006, 0, COS, { 0, 1, 0, 2,-1,-4, 0 } },
  { -0.00006, 0, SIN, { 0, 1,-1, 0,-1, 0, 0 } },
  { -0.00006, 2, COS, { 0, 1, 0, 0,-1, 0, 0 } },
  { -0.00006, 1, COS, { 0, 1, 0, 0,-1, 0, 0 } },
  {  0.00006, 1, COS, { 0, 0, 0, 2, 0,-6, 0 } },
  {  0.00005, 0, COS, { 0, 1, 1, 0,-1,-1, 0 } },
  {  0.00005, 1, SIN, { 0, 0, 0, 2, 0,-4, 0 } },
  {  0.00005, 1, SIN, { 0, 1, 0,-2,-1, 5, 0 } },
  { -0.00004, 0, SIN, { 0, 0, 0, 3, 0,-3, 0 } },
  {  0.00004, 0, SIN, { 0, 1, 0, 0,-1,-1, 0 } },
  {  0.00004, 0, SIN, { 0, 0, 0, 0, 0, 2, 0 } },
  {  0.00004, 1, SIN, { 0, 1, 1, 0,-1, 0, 0 } },
  {  0.00004, 0, SIN, { 0, 1, 0, 0,-1, 2, 0 } },
  { -0.00004, 0, COS, { 0, 0, 0, 0, 0, 2,-3 } },
  { -0.00004, 0, SIN, { 0, 1, 0, 0,-1,-2, 0 } },
  {  0.00004, 0, COS, { 0, 0, 0, 2, 0,-7, 0 } },
  { -0.00004, 1, COS, { 0, 1, 0, 0,-1,-1, 0 } },
  { -0.00004, 1, COS, { 0, 0, 0, 0, 0, 2, 0 } },
  {  0.00004, 0, SIN, { 0, 0, 0, 2, 0,-7, 0 } },
  { -0.00003, 0, SIN, { 0, 1, 0, 0,-3, 0, 0 } },
  { -0.00003, 0, SIN, { 0, 1, 0, 0, 1, 0, 0 } },
  {  0.00003, 0, SIN, { 0, 1,-1,-2,-1, 5, 0 } },
  {  0.00003, 0, COS, { 0, 1, 0, 0,-3, 0, 0 } },
  {  0.00003, 0, SIN, { 0, 1,-1, 2,-1,-5, 0 } },
  { -0.00003, 0, COS, { 0, 1, 0, 0, 1, 0, 0 } },
  { -0.00003, 0, SIN, { 0, 0, 0, 1, 0,-2, 0 } },
  { -0.00003, 0, COS, { 0, 1, 0, 2,-1,-6, 0 } },
  { -0.00003, 0, COS, { 0, 0, 0, 0, 0, 3, 0 } },
  {  0.00003, 0, COS, { 0, 1, 0,-1,-1, 1, 0 } }
};

struct Term wSaturn[102] = {
  {      0.0,101,  7, { 5, 7, 8,19,21,22,25 } },
  {  0.10619, 0, SIN, { 0, 0, 0, 0, 0, 1, 0 } },
  {  0.09967, 0, SIN, { 0, 1, 0, 0,-1, 0, 0 } },
  { -0.04059, 0, SIN, { 0, 0, 0, 0, 2, 0, 0 } },
  {  0.02307, 1, COS, { 0, 0, 0, 0, 0, 0, 0 } },
  { -0.01237, 0, COS, { 0, 0, 0, 2, 0,-5, 0 } },
  {  0.01151, 0, COS, { 0, 0, 0, 0, 0, 0, 0 } },
  { -0.00795, 0, SIN, { 0, 0, 0, 0, 1, 1, 0 } },
  {  0.00795, 0, SIN, { 0, 0, 0, 0, 1,-1, 0 } },
  {  0.00542, 0, SIN, { 0, 0, 0, 2, 0,-5, 0 } },
  { -0.00429, 0, SIN, { 0, 1, 0, 0, 1, 0, 0 } },
  { -0.00347, 0, COS, { 0, 0, 0, 2, 0,-4, 0 } },
  {  0.00340, 0, SIN, { 0, 0, 0, 0, 2,-1, 0 } },
  {  0.00321, 0, COS, { 0, 0, 0, 0, 1, 1, 0 } },
  {  0.00321, 0, COS, { 0, 0, 0, 0, 1,-1, 0 } },
  { -0.00250, 0, SIN, { 0, 1,-1, 0,-1, 0, 0 } },
  { -0.00235, 1, COS, { 0, 0, 0, 0, 0, 1, 0 } },
  {  0.00195, 0, SIN, { 0, 0, 0, 1, 0,-2, 0 } },
  { -0.00116, 0, COS, { 0, 0, 0, 0, 0, 1, 0 } },
  { -0.00112, 0, SIN, { 0, 0, 0, 0, 2, 1, 0 } },
  { -0.00100, 1, COS, { 0, 0, 0, 0, 2, 0, 0 } },
  {  0.00083, 0, SIN, { 0, 1, 1, 0,-1, 0, 0 } },
  { -0.00082, 0, COS, { 0, 0, 0, 0, 2, 0, 0 } },
  {  0.00072, 0, SIN, { 0, 0, 0, 0, 0, 2, 0 } },
  { -0.00069, 1, SIN, { 0, 0, 0, 0, 0, 1, 0 } },
  { -0.00053, 0, COS, { 0, 0, 0, 0, 1, 0, 0 } },
  {  0.00046, 1, SIN, { 0, 0, 0, 2, 0,-5, 0 } },
  { -0.00035, 0, COS, { 0, 0, 0, 2, 0,-6, 0 } },
  {  0.00028, 1, COS, { 0, 0, 0, 2, 0,-5, 0 } },
  {  0.00027, 0, COS, { 0, 0, 0, 2, 2,-5, 0 } },
  {  0.00026, 0, COS, { 0, 0, 0, 2,-2,-5, 0 } },
  { -0.00022, 0, SIN, { 0, 0, 0, 0, 1, 2, 0 } },
  {  0.00022, 0, SIN, { 0, 0, 0, 0, 1,-2, 0 } },
  { -0.00022, 0, SIN, { 0, 0, 0, 2, 0,-4, 0 } },
  {  0.00017, 0, SIN, { 0, 0, 0, 1, 0,-3, 0 } },
  {  0.00015, 0, SIN, { 0, 0, 0, 2, 0,-6, 0 } },
  {  0.00013, 0, SIN, { 0, 0, 0, 2, 0,-2, 0 } },
  { -0.00013, 0, SIN, { 0, 0, 0, 2, 0,-6, 3 } },
  {  0.00013, 0, COS, { 0, 0, 0, 1, 0,-3, 0 } },
  { -0.00012, 0, SIN, { 0, 0, 0, 2, 2,-5, 0 } },
  {  0.00012, 1, COS, { 0, 0, 0, 0, 2,-1, 0 } },
  {  0.00011, 0, SIN, { 0, 0, 0, 2, 0,-3, 0 } },
  {  0.00011, 0, SIN, { 0, 1,-1, 0, 1, 0, 0 } },
  { -0.00011, 0, SIN, { 0, 0, 0, 2,-2,-5, 0 } },
  {  0.00010, 0, COS, { 0, 0, 0, 2,-2,-4, 0 } },
  { -0.00010, 0, SIN, { 0, 0, 0, 0, 0, 1,-3 } },
  {  0.00010, 0, COS, { 0, 0, 0, 0, 2,-1, 0 } },
  { -0.00010, 0, COS, { 0, 1, 0, 0,-1, 0, 0 } },
  {  0.00009, 0, COS, { 0, 0, 0, 4, 0,-10,0 } },
  {  0.00009, 0, COS, { 0, 0, 0, 0, 1, 2, 0 } },
  {  0.00009, 0, COS, { 0, 0, 0, 0, 1,-2, 0 } },
  {  0.00009, 0, COS, { 0, 0, 0, 0, 0, 2,-3 } },
  {  0.00009, 0, SIN, { 0, 0, 0, 4, 0,-10,0 } },
  { -0.00008, 0, SIN, { 1, 0, 0, 0, 0, 0, 0 } },
  { -0.00008, 1, COS, { 0, 0, 0, 0, 1, 1, 0 } },
  { -0.00008, 1, COS, { 0, 0, 0, 0, 1,-1, 0 } },
  { -0.00008, 0, COS, { 0, 0, 0, 0, 0, 1,-3 } },
  {  0.00007, 0, COS, { 0, 0, 0, 2, 1,-4, 0 } },
  {  0.00007, 0, COS, { 0, 0, 0, 2,-1,-4, 0 } },
  {  0.00007, 0, SIN, { 0, 0, 0, 1, 0,-1, 0 } },
  {  0.00006, 0, SIN, { 0, 0, 0, 0, 0, 3, 0 } },
  {  0.00006, 0, COS, { 0, 0, 0, 2, 0,-3, 0 } },
  {  0.00006, 1, SIN, { 0, 0, 0, 2, 0,-4, 0 } },
  { -0.00005, 0, SIN, { 0, 0, 0, 0, 0, 2,-2 } },
  { -0.00005, 0, SIN, { 0, 0, 0, 1,-2,-2, 0 } },
  { -0.00005, 0, SIN, { 0, 0, 0, 0, 2, 2, 0 } },
  {  0.00005, 0, SIN, { 0, 0, 0, 4, 0,-9, 0 } },
  {  0.00005, 1, SIN, { 0, 0, 0, 0, 2, 0, 0 } },
  {  0.00005, 0, COS, { 0, 0, 0, 2, 2,-4, 0 } },
  {  0.00005, 0, SIN, { 0, 0, 0, 0, 0, 2,-3 } },
  { -0.00004, 0, SIN, { 0, 0, 0, 2, 1,-6, 0 } },
  { -0.00004, 0, SIN, { 0, 0, 0, 2,-1,-6, 0 } },
  { -0.00004, 2, SIN, { 0, 0, 0, 0, 0, 1, 0 } },
  {  0.00004, 0, COS, { 0, 0, 0, 2, 1,-6, 0 } },
  {  0.00004, 0, COS, { 0, 0, 0, 2,-1,-6, 0 } },
  {  0.00004, 0, COS, { 0, 0, 0, 2, 0,-2, 0 } },
  { -0.00004, 0, SIN, { 0, 0, 0, 0, 0, 1,-2 } },
  {  0.00004, 0, COS, { 0, 0, 0, 0, 0, 1,-1 } },
  { -0.00004, 0, SIN, { 0, 1, 1, 0, 1, 0, 0 } },
  { -0.00003, 0, SIN, { 0, 0, 0, 1, 2,-2, 0 } },
  { -0.00003, 1, SIN, { 0, 0, 0, 4, 0,-10,0 } },
  {  0.00003, 1, COS, { 0, 0, 0, 0, 1, 0, 0 } },
  { -0.00003, 0, COS, { 0, 0, 0, 0, 2, 1, 0 } },
  {  0.00003, 1, COS, { 0, 0, 0, 4, 0,-10,0 } },
  { -0.00003, 1, SIN, { 0, 0, 0, 0, 2,-1, 0 } },
  { -0.00002, 0, SIN, { 0, 0, 0, 3, 0,-7, 0 } },
  {  0.00002, 1, COS, { 0, 0, 0, 0, 0, 2,-2 } },
  { -0.00002, 0, SIN, { 0, 0, 0, 0, 2,-2, 0 } },
  { -0.00002, 0, COS, { 0, 0, 0, 2, 0,-7, 0 } },
  { -0.00002, 0, COS, { 0, 0, 0, 0, 0, 2, 0 } },
  { -0.00002, 0, COS, { 0, 0, 0, 0, 0, 3, 0 } },
  {  0.00002, 0, SIN, { 0, 0, 0, 3, 0,-4, 0 } },
  { -0.00002, 0, COS, { 0, 0, 0, 3, 0,-3, 0 } },
  {  0.00002, 0, COS, { 0, 0, 0, 2, 1,-5, 0 } },
  {  0.00002, 0, COS, { 0, 0, 0, 2,-1,-5, 0 } },
  {  0.00002, 1, SIN, { 0, 0, 0, 1, 0,-1, 0 } },
  {  0.00002, 0, COS, { 0, 0, 0, 1, 2,-1, 0 } },
  { -0.00002, 0, COS, { 0, 0, 0, 1,-2,-1, 0 } },
  { -0.00002, 1, COS, { 0, 0, 0, 0, 2, 1, 0 } },
  {  0.00002, 0, COS, { 0, 0, 0, 1, 0, 0, 0 } },
  { -0.00002, 1, SIN, { 0, 0, 0, 2, 2,-5, 0 } },
  {  0.00002, 0, COS, { 0, 0, 0, 2,-2,-6, 0 } }
};

static double reduce(double value, double rangeMin, double rangeMax) 
{ 
  double range, rangeFrac, fullRanges, retval;

  range     = rangeMax-rangeMin;
  rangeFrac = (rangeMax-value)/range;

  modf(rangeFrac, &fullRanges);
  retval = value + fullRanges*range;
  if (retval > rangeMax) retval -= range;

  return(retval);
}

/* 
   Note, that we don't use arg[0] in order to have the same numbering
   as in the original reference.
*/
double argument(int i, double tu)
{
  static int done = 0;
  static double arg[34];

  if (!done) {
    /* mean longitude of the Moon */
    arg[ 1] = 0.606434 + 0.03660110129*tu;
    /* mean anomaly of the Moon */
    arg[ 2] = 0.374897 + 0.03629164709*tu;
    /* argument of latitude of the Moon */
    arg[ 3] = 0.259091 + 0.03674819520*tu;
    /* mean elongation of the Moon from the Sun */
    arg[ 4] = 0.827362 + 0.03386319198*tu;
    /* longitude of lunar ascending node */
    arg[ 5] = 0.347343 - 0.00014709391*tu;

    /* mean longitude of the Sun */
    arg[ 7] = 0.779072 + 0.00273790931*tu;
    /* mean anomaly of the Sun */
    arg[ 8] = 0.993126 + 0.00273777850*tu;

    /* mean longitude of Mercury */
    arg[ 9] = 0.700695 + 0.01136771400*tu;
    /* mean longitude of Mercury */
    arg[10] = 0.485541 + 0.01136759566*tu;
    /* argument of latitude of Mercury */
    arg[11] = 0.566441 + 0.01136762384*tu;


    /* mean longitude of Venus */
    arg[12] = 0.505498 + 0.00445046867*tu;
    /* mean longitude of Venus */
    arg[13] = 0.140023 + 0.00445036173*tu;
    /* argument of latitude of Venus */
    arg[14] = 0.292498 + 0.00445040017*tu;

    /* mean longitude of Mars */
    arg[15] = 0.987353 + 0.00145575328*tu;
    /* mean longitude of Mars */
    arg[16] = 0.053856 + 0.00145561327*tu;
    /* argument of latitude of Mars */
    arg[17] = 0.849694 + 0.00145569465*tu;

    /* mean longitude of Jupiter */
    arg[18] = 0.089608 + 0.00023080893*tu;
    /* mean longitude of Jupiter */
    arg[19] = 0.056531 + 0.00023080893*tu;
    /* argument of latitude of Jupiter */
    arg[20] = 0.814794 + 0.00023080893*tu;

    /* mean longitude of Saturn */
    arg[21] = 0.133295 + 0.00009294371*tu;
    /* mean longitude of Saturn */
    arg[22] = 0.882987 + 0.00009294371*tu;
    /* argument of latitude of Saturn */
    arg[23] = 0.821218 + 0.00009294371*tu;

    /* mean longitude of Uranus */
    arg[24] = 0.870169 + 0.00003269438*tu;
    /* mean longitude of Uranus */
    arg[25] = 0.400589 + 0.00003269438*tu;
    /* argument of latitude of Uranus */
    arg[26] = 0.664614 + 0.00003265562*tu;

    /* mean longitude of Neptune */
    arg[27] = 0.846912 + 0.00001672092*tu;
    /* mean longitude of Neptune */
    arg[28] = 0.725368 + 0.00001672092*tu;
    /* argument of latitude of Neptune */
    arg[29] = 0.480856 + 0.00001663715*tu;

    /* mean longitude of Pluto */
    arg[31] = 0.663854 + 0.00001115482*tu;
    /* mean longitude of Pluto */
    arg[32] = 0.041020 + 0.00001104864*tu;
    /* argument of latitude of Pluto */
    arg[33] = 0.357355 + 0.00001104864*tu;
  }
  return TWOPI*reduce(arg[i], 0.0, 1.0);
}

double evaluate(struct Term *t, double tu, double Tu)
{
  int i, j, n, nterms;
  double arg, A, T, result;
  
  nterms = t[0].nT;
  
  result = 0.0;
  for (i = 1; i <= t[0].nT; i++) {
    A = t[i].a;

    T = 1.0;
    for (j = 0; j < t[i].nT; j++) T *= Tu;

    arg = 0.0;
    for (j = 0; j < t[0].trig; j++) {
      n = t[0].trigarg[j];
      if (n) arg += (double)t[i].trigarg[j]*argument(n, tu);
    }

    if (t[i].trig == COS) arg = cos(arg);
    else                  arg = sin(arg);

    result += A*T*arg;
  }
  return result;
}
/*
void length()
{
  int nT;

  nT = sizeof(plonSun)/sizeof(struct Term);
  printf ("plonSun:     %d\n", nT);
  nT = sizeof(betaSun)/sizeof(struct Term);
  printf ("betaSun:     %d\n", nT);
  nT = sizeof(rpSun)/sizeof(struct Term);
  printf ("rpSun:       %d\n", nT);

  nT = sizeof(vSun)/sizeof(struct Term);
  printf ("vSun:        %d\n", nT);
  nT = sizeof(uSun)/sizeof(struct Term);
  printf ("uSun:        %d\n", nT);
  nT = sizeof(wSun)/sizeof(struct Term);
  printf ("wSun:        %d\n", nT);

  nT = sizeof(plonMoon)/sizeof(struct Term);
  printf ("plonMoon:    %d\n", nT);
  nT = sizeof(betaMoon)/sizeof(struct Term);
  printf ("betaMoon:    %d\n", nT);
  nT = sizeof(rpMoon)/sizeof(struct Term);
  printf ("rpMoon:      %d\n", nT);

  nT = sizeof(vMoon)/sizeof(struct Term);
  printf ("vMoon:       %d\n", nT);
  nT = sizeof(uMoon)/sizeof(struct Term);
  printf ("uMoon:       %d\n", nT);
  nT = sizeof(wMoon)/sizeof(struct Term);
  printf ("wMoon:       %d\n", nT);

  nT = sizeof(plonJupiter)/sizeof(struct Term);
  printf ("plonJupiter: %d\n", nT);
  nT = sizeof(betaJupiter)/sizeof(struct Term);
  printf ("betaJupiter: %d\n", nT);
  nT = sizeof(rpJupiter)/sizeof(struct Term);
  printf ("rpJupiter:   %d\n", nT);

  nT = sizeof(vJupiter)/sizeof(struct Term);
  printf ("vJupiter:    %d\n", nT);
  nT = sizeof(uJupiter)/sizeof(struct Term);
  printf ("uJupiter:    %d\n", nT);
  nT = sizeof(wJupiter)/sizeof(struct Term);
  printf ("wJupiter:    %d\n", nT);

  nT = sizeof(vSaturn)/sizeof(struct Term);
  printf ("vSaturn:     %d\n", nT);
  nT = sizeof(uSaturn)/sizeof(struct Term);
  printf ("uSaturn:     %d\n", nT);
  nT = sizeof(wSaturn)/sizeof(struct Term);
  printf ("wSaturn:     %d\n", nT);
}

void equatorial(double JD, double r, double l, double b, 
		double *ra, double *dec, double *rho)
{
  double e;
  double tu, Tu;
  cVector x;
  pVector p;

  tu = JD - J2000;
  Tu = tu/36525.0 + 1.0;
  e = eps(JD);
  printf("eps: %12.5f\n", e*180.0/PI);
  e = 84428.0-47.0*Tu+9.0*cos(argument(5, tu));
  e *= (PI/180.0)/3600.0;
  printf("eps: %12.5f\n", e*180.0/PI);
  b *= PI/180.0/3600.0;
  l *= PI/180.0/3600.0;
  printf("lon: %s\n", angle(l, 0));
  printf("lat: %s\n", angle(b, 0));

  x[0] = cos(b)*cos(l);
  x[1] = cos(b)*sin(l)*cos(e)-sin(b)*sin(e);
  x[2] = cos(b)*sin(l)*sin(e)+sin(b)*cos(e);

  uvc(x, &p);
  printf("R.A: %s\n", angle(p.l, 1));
  printf("Dec: %s\n", angle(p.b, 0));
  *ra = p.l;
  *dec = p.b;
}
*/

/*  extern char *angle(double, int); */

#define NBODIES 4
#define SUN     0
#define MOON    1
#define JUPITER 2
#define SATURN  3

static double result[NBODIES][3];

double *Sun(double JD)
{
  double tu, Tu;
  double v, u, w;
  double ra, dec, rho;

  tu = JD - J2000;         /* time since 2000.0 [d]   */
  Tu = tu/36525.0 + 1.0;   /* time since 1900.0 [jcy] */

  v =  evaluate(vSun, tu, Tu);
  u =  evaluate(uSun, tu, Tu);
  w =  evaluate(wSun, tu, Tu);

  ra = w/sqrt(u-v*v);
  ra = argument(7, tu) + atan(ra/sqrt(1.0-ra*ra));
  ra = reduce(ra, 0.0, TWOPI);

  dec = v/sqrt(u);
  dec = atan(dec/sqrt(1.0-dec*dec));
  dec = reduce(dec, -PI, PI);

  rho = 1.00021*sqrt(u);
  rho *= 1.49597892e11;  /* convert AU to m */ 

  result[SUN][0] = rho*cos(ra)*cos(dec);
  result[SUN][1] = rho*sin(ra)*cos(dec);
  result[SUN][2] = rho*sin(dec);

/*    printf("v   (Sun    )   : %12.5f\n", v); */
/*    printf("u   (Sun    )   : %12.5f\n", u); */
/*    printf("w   (Sun    )   : %12.5f\n", w); */

/*    printf("RA  (Sun    )   : %s\n", angle(ra, 1)); */
/*    printf("Dec (Sun    )   : %s\n", angle(dec, 0)); */
/*    printf("Rho (Sun    )   : %12.5f\n", rho); */

/*    printf("X   (Sun    )   : %12.5f\n", result[SUN][0]); */
/*    printf("Y   (Sun    )   : %12.5f\n", result[SUN][1]); */
/*    printf("Z   (Sun    )   : %12.5f\n", result[SUN][2]); */

/*    printf("\n"); */

  return (result[SUN]);
}

double *Moon(double JD)
{
  double tu, Tu;
  double v, u, w;
  double ra, dec, rho;

  tu = JD - J2000;         /* time since 2000.0 [d]   */
  Tu = tu/36525.0 + 1.0;   /* time since 1900.0 [jcy] */

  v =  evaluate(vMoon, tu, Tu);
  u =  evaluate(uMoon, tu, Tu);
  w =  evaluate(wMoon, tu, Tu);

  ra = w/sqrt(u-v*v);
  ra = argument(1, tu) + atan(ra/sqrt(1.0-ra*ra));
  ra = reduce(ra, 0.0, TWOPI);

  dec = v/sqrt(u);
  dec = atan(dec/sqrt(1.0-dec*dec));
  dec = reduce(dec, -PI, PI);

  rho = 60.40974*sqrt(u);
  rho *= 6.378137e6;      /* multiply with equatorial radius in m */

  result[MOON][0] = rho*cos(ra)*cos(dec);
  result[MOON][1] = rho*sin(ra)*cos(dec);
  result[MOON][2] = rho*sin(dec);

/*    printf("v   (Moon   )   : %12.5f\n", v); */
/*    printf("u   (Moon   )   : %12.5f\n", u); */
/*    printf("w   (Moon   )   : %12.5f\n", w); */

/*    printf("RA  (Moon   )   : %s\n", angle(ra, 1)); */
/*    printf("Dec (Moon   )   : %s\n", angle(dec, 0)); */
/*    printf("Rho (Moon   )   : %12.5f\n", rho); */

/*    printf("X   (Moon   )   : %12.5f\n", result[MOON][0]); */
/*    printf("Y   (Moon   )   : %12.5f\n", result[MOON][1]); */
/*    printf("Z   (Moon   )   : %12.5f\n", result[MOON][2]); */

/*    printf("\n"); */

  return (result[MOON]);
}

double *Jupiter(double JD)
{
  double tu, Tu;
  double v, u, w;
  double ra, dec, rho;

  tu = JD - J2000;         /* time since 2000.0 [d]   */
  Tu = tu/36525.0 + 1.0;   /* time since 1900.0 [jcy] */

  v =  evaluate(vJupiter, tu, Tu);
  u =  evaluate(uJupiter, tu, Tu);
  w =  evaluate(wJupiter, tu, Tu);

  ra = w/sqrt(u-v*v);
  ra = argument(18, tu) + atan(ra/sqrt(1.0-ra*ra));
  ra = reduce(ra, 0.0, TWOPI);

  dec = v/sqrt(u);
  dec = atan(dec/sqrt(1.0-dec*dec));
  dec = reduce(dec, -PI, PI);

  rho = 5.30693*sqrt(u);
  rho *= 1.49597892e11;  /* convert AU to m */ 

  result[JUPITER][0] = rho*cos(ra)*cos(dec);
  result[JUPITER][1] = rho*sin(ra)*cos(dec);
  result[JUPITER][2] = rho*sin(dec);

/*    printf("v   (Jupiter)   : %12.5f\n", v); */
/*    printf("u   (Jupiter)   : %12.5f\n", u); */
/*    printf("w   (Jupiter)   : %12.5f\n", w); */

/*    printf("RA  (Jupiter)   : %s\n", angle(ra, 1)); */
/*    printf("Dec (Jupiter)   : %s\n", angle(dec, 0)); */
/*    printf("Rho (Jupiter)   : %12.5f\n", rho); */

/*    printf("X   (Jupiter)   : %12.5f\n", result[JUPITER][0]); */
/*    printf("Y   (Jupiter)   : %12.5f\n", result[JUPITER][1]); */
/*    printf("Z   (Jupiter)   : %12.5f\n", result[JUPITER][2]); */

/*    printf("\n"); */

  return (result[JUPITER]);
}

double *Saturn(double JD)
{
  double tu, Tu;
  double v, u, w;
  double ra, dec, rho;

  tu = JD - J2000;         /* time since 2000.0 [d]   */
  Tu = tu/36525.0 + 1.0;   /* time since 1900.0 [jcy] */

  v =  evaluate(vSaturn, tu, Tu);
  u =  evaluate(uSaturn, tu, Tu);
  w =  evaluate(wSaturn, tu, Tu);

  ra = w/sqrt(u-v*v);
  ra = argument(21, tu) + atan(ra/sqrt(1.0-ra*ra));
  ra = reduce(ra, 0.0, TWOPI);

  dec = v/sqrt(u);
  dec = atan(dec/sqrt(1.0-dec*dec));
  dec = reduce(dec, -PI, PI);

  rho = 9.61711*sqrt(u);
  rho *= 1.49597892e11;  /* convert AU to m */ 

  result[SATURN][0] = rho*cos(ra)*cos(dec);
  result[SATURN][1] = rho*sin(ra)*cos(dec);
  result[SATURN][2] = rho*sin(dec);

/*    printf("v   (Saturn )   : %12.5f\n", v); */
/*    printf("u   (Saturn )   : %12.5f\n", u); */
/*    printf("w   (Saturn )   : %12.5f\n", w); */

/*    printf("RA  (Saturn )   : %s\n", angle(ra, 1)); */
/*    printf("Dec (Saturn )   : %s\n", angle(dec, 0)); */
/*    printf("Rho (Saturn )   : %12.5f\n", rho); */

/*    printf("X   (Saturn )   : %12.5f\n", result[SATURN][0]); */
/*    printf("Y   (Saturn )   : %12.5f\n", result[SATURN][1]); */
/*    printf("Z   (Saturn )   : %12.5f\n", result[SATURN][2]); */

/*    printf("\n"); */

  return (result[SATURN]);
}

